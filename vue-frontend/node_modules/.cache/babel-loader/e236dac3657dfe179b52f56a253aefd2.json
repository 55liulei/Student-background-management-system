{"remainingRequest":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/babel-loader/lib/index.js!/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/liulei/Desktop/Vue/vue-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liulei/Desktop/Vue/vue-frontend/src/views/students/School.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liulei/Desktop/Vue/vue-frontend/src/views/students/School.vue","mtime":1658734294145},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/babel.config.js","mtime":1658195622849},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1657875963855},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/babel-loader/lib/index.js","mtime":1657875486856},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1657875963855},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/vue-loader/lib/index.js","mtime":1657875961434}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHNjaG9vbEFwaSBmcm9tICJAL2FwaS9zY2hvb2wuanMiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHNjaG9vbEZvcm1WaXNpYmxlOiBmYWxzZSwKICAgICAgLy/nvJbovpHnqpflj6PmmK/lkKbmmL7npLoKICAgICAgc2Nob29sOiB7CiAgICAgICAgX2lkOiBudWxsLAogICAgICAgIHNjaG9vbG5hbWU6ICIiCiAgICAgIH0sCiAgICAgIHNjaG9vbHM6IFtdLAogICAgICB0b3RhbFBhZ2U6IDEsCiAgICAgIHBhZ2VTaXplOiA1LAogICAgICAvL+avj+mhteaYvuekuuadoeaVsAogICAgICBjdXJyZW50UGFnZTogMSwKICAgICAgLy/lvZPliY3pobUKICAgICAgdG90YWw6IDAsCiAgICAgIC8v5oC76K6hCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgc2Nob29sTmFtZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIuWtpuagoeWQjeensOW/hemhu+i+k+WFpSIsCiAgICAgICAgICB0cmlnZ2VyOiBbImJsdXIiLCAiY2hhbmdlIl0KICAgICAgICB9XQogICAgICB9CiAgICB9OwogIH0sCgogIGNvbXBvbmVudHM6IHt9LAoKICBtb3VudGVkKCkgewogICAgdGhpcy5mZXRjaFNjaG9vbCgpOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFkZERhdGEoZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUodmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgc2Nob29sQXBpLmFkZFNjaG9vbCh0aGlzLnNjaG9vbCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHJlc3AgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwLCAncmVzJyk7CgogICAgICAgICAgICBpZiAocmVzcC5zdGF0dXMgPT0gMCkgewogICAgICAgICAgICAgIHRoaXMuc2Nob29sRm9ybVZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLmZldGNoU2Nob29sKCk7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5re75Yqg5a2m5qCh5oiQ5YqfIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coImVycm9yIHN1Ym1pdCIsIGVycm9yKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICB1cGRhdGVEYXRhKGZvcm1OYW1lKSB7CiAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnZhbGlkYXRlKHZhbGlkID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIHNjaG9vbEFwaS51cGRhdGVTY2hvb2wodGhpcy5zY2hvb2wpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICBjb25zdCByZXNwID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICAgICAgdGhpcy5zY2hvb2xGb3JtVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuZmV0Y2hTY2hvb2woKTsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICLmm7TmlrDlrabmoKHmiJDlip8iCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiZXJyb3Igc3VibWl0IiwgZXJyb3IpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIGhhbmRsZUFkZCgpIHsKICAgICAgdGhpcy5zY2hvb2wgPSB7CiAgICAgICAgX2lkOiBudWxsLAogICAgICAgIHNjaG9vbG5hbWU6ICIiCiAgICAgIH07CiAgICAgIHRoaXMuc2Nob29sRm9ybVZpc2libGUgPSB0cnVlOwogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy4kcmVmc1sic2Nob29sRm9ybSJdLnJlc2V0RmllbGRzKCk7CiAgICAgIH0pOwogICAgfSwKCiAgICBoYW5kbGVFZGl0KF9pZCkgewogICAgICB0aGlzLmhhbmRsZUFkZCgpOwogICAgICBzY2hvb2xBcGkuZ2V0U2Nob29sQnlJZChfaWQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGNvbnN0IHJlc3AgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICBpZiAocmVzcC5zdGF0dXMgPT0gMCkgewogICAgICAgICAgdGhpcy5zY2hvb2wgPSByZXNwLmRhdGE7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgaGFuZGxlRGVsZXRlKF9pZCkgewogICAgICB0aGlzLiRjb25maXJtKCLnoa7orqTliKDpmaTor6XnlKjmiLflkJfvvJ8iLCAi5o+Q56S6IiwgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu5a6aIiwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAi5Y+W5raIIiwKICAgICAgICB0eXBlOiAid2FybmluZyIKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgc2Nob29sQXBpLmRlbGV0ZVNjaG9vbEJ5SWQoX2lkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIGNvbnN0IHJlc3AgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICBtZXNzYWdlOiAi5Yig6Zmk5a2m5qCh5oiQ5YqfISIKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMudG90YWxQYWdlID0gKHRoaXMudG90YWwgLSAxKSAvIHRoaXMucGFnZVNpemU7CiAgICAgICAgICAgIHRoaXMuZmV0Y2hTY2hvb2woKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSkuY2F0Y2goKCkgPT4ge30pOwogICAgfSwKCiAgICBoYW5kbGVTaXplQ2hhbmdlKHZhbCkgewogICAgICB0aGlzLnBhZ2VTaXplID0gdmFsOwogICAgICB0aGlzLmZldGNoU2Nob29sKCk7CiAgICB9LAoKICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UodmFsKSB7CiAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSB2YWw7CiAgICAgIHRoaXMuZmV0Y2hTY2hvb2woKTsKICAgIH0sCgogICAgZmV0Y2hTY2hvb2woKSB7CiAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlID4gTWF0aC5jZWlsKHRoaXMudG90YWxQYWdlKSkgewogICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSBNYXRoLmNlaWwodGhpcy50b3RhbFBhZ2UpOwogICAgICB9CgogICAgICBzY2hvb2xBcGkuZ2V0U2Nob29sTGlzdCh0aGlzLmN1cnJlbnRQYWdlLCB0aGlzLnBhZ2VTaXplKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBjb25zdCByZXMgPSByZXNwb25zZS5kYXRhOwogICAgICAgIGNvbnNvbGUubG9nKCctLS0tLS0nLCByZXMpOwoKICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICB0aGlzLnNjaG9vbHMgPSByZXMuZGF0YS5kYXRhOwogICAgICAgICAgdGhpcy50b3RhbCA9IHJlcy5kYXRhLnRvdGFsOwogICAgICAgICAgdGhpcy50b3RhbFBhZ2UgPSB0aGlzLnRvdGFsIC8gdGhpcy5wYWdlU2l6ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICB9Cn07"},{"version":3,"mappings":"AAwEA;AACA;EACAA;IACA;MACAC,wBADA;MACA;MACAC;QACAC,SADA;QAEAC;MAFA,CAFA;MAMAC,WANA;MAOAC,YAPA;MAQAC,WARA;MAQA;MACAC,cATA;MASA;MACAC,QAVA;MAUA;MACAC;QACAC,aACA;UACAC,cADA;UAEAC,mBAFA;UAGAC;QAHA,CADA;MADA;IAXA;EAqBA,CAvBA;;EAyBAC,cAzBA;;EA0BAC;IACA;EACA,CA5BA;;EA8BAC;IACAC;MACA;QACA;UACAC;YACA;YACAC;;YACA;cACA;cACA;cACA;gBACAC,eADA;gBAEAR;cAFA;YAIA;UACA,CAXA;QAYA,CAbA,MAaA;UACAO;UACA;QACA;MACA,CAlBA;IAmBA,CArBA;;IAsBAE;MACA;QACA;UACAH;YACA;;YACA;cACA;cACA;cACA;gBACAE,eADA;gBAEAR;cAFA;YAIA;UACA,CAVA;QAWA,CAZA,MAYA;UACAO;UACA;QACA;MACA,CAjBA;IAkBA,CAzCA;;IA0CAG;MACA;QACApB,SADA;QAEAC;MAFA;MAIA;MACA;QACA;MACA,CAFA;IAGA,CAnDA;;IAoDAoB;MACA;MACAL;QACA;;QACA;UACA;QACA;MACA,CALA;IAMA,CA5DA;;IA6DAM;MACA;QACAC,uBADA;QAEAC,sBAFA;QAGAN;MAHA,GAKAO,IALA,CAKA;QACAT;UACA;;UACA;YACA;cACAE,eADA;cAEAR;YAFA;YAIA;YACA;UACA;QACA,CAVA;MAWA,CAjBA,EAiBAgB,KAjBA,CAiBA,QAjBA;IAkBA,CAhFA;;IAiFAC;MACA;MACA;IACA,CApFA;;IAqFAC;MACA;MACA;IACA,CAxFA;;IAyFAC;MACA;QACA;MACA;;MACAb,UACAc,aADA,CACA,gBADA,EACA,aADA,EAEAL,IAFA,CAEAM;QACA;QACAd;;QACA;UACA;UACA;UACA;QACA;MACA,CAVA;IAWA;;EAxGA;AA9BA","names":["data","schoolFormVisible","school","_id","schoolname","schools","totalPage","pageSize","currentPage","total","rules","schoolName","required","message","trigger","components","mounted","methods","addData","schoolApi","console","type","updateData","handleAdd","handleEdit","handleDelete","confirmButtonText","cancelButtonText","then","catch","handleSizeChange","handleCurrentChange","fetchSchool","getSchoolList","response"],"sourceRoot":"src/views/students","sources":["School.vue"],"sourcesContent":["<template>\n  <div>\n    <div style=\"margin: 20px\" class=\"btn_bos\">\n      <el-button type=\"primary\" @click=\"handleAdd\">添加学校</el-button>\n    </div>\n    <el-table :data=\"schools\" height=\"380\" border style=\"width: 100%\">\n      <el-table-column label=\"序号\" type=\"index\" width=\"60\"></el-table-column>\n      <el-table-column label=\"学校名称\" prop=\"schoolname\"></el-table-column>\n      <el-table-column label=\"操作\" width=\"250\">\n        <template slot-scope=\"scope\">\n          <el-button size=\"mini\" @click=\"handleEdit(scope.row._id)\"\n            >编辑</el-button\n          >\n          <el-button\n            size=\"mini\"\n            type=\"danger\"\n            @click=\"handleDelete(scope.row._id)\"\n            >删除</el-button\n          >\n        </template>\n      </el-table-column>\n    </el-table>\n    <el-dialog\n      title=\"添加/编辑\"\n      :visible.sync=\"schoolFormVisible\"\n      width=\"500px\"\n    >\n      <el-form\n        status-icon\n        :model=\"school\"\n        ref=\"schoolForm\"\n        label-width=\"100px\"\n        label-position=\"right\"\n        style=\"width: 400px\"\n        :rules=\"rules\"\n      >\n        <el-form-item label=\"学校名称\" prop=\"schoolname\">\n          <el-input\n            v-model=\"school.schoolname\"\n            placeholder=\"请输入学校名称\"\n          ></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"schoolFormVisible = false\">取 消</el-button>\n        <el-button\n          type=\"primary\"\n          @click=\"\n            school._id == null\n              ? addData('schoolForm')\n              : updateData('schoolForm')\n          \"\n          >确 定</el-button\n        >\n      </div>\n    </el-dialog>\n    <div>\n      <el-pagination\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n        :current-page=\"currentPage\"\n        :page-sizes=\"[5, 10, 15, 20]\"\n        :page-size=\"pageSize\"\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"total\"\n      >\n      </el-pagination>\n    </div>\n  </div>\n</template>\n\n<script>\nimport schoolApi from \"@/api/school.js\";\nexport default {\n  data() {\n    return {\n      schoolFormVisible: false, //编辑窗口是否显示\n      school: {\n        _id: null,\n        schoolname: \"\",\n      },\n      schools:[],\n      totalPage:1,\n      pageSize: 5, //每页显示条数\n      currentPage: 1, //当前页\n      total: 0, //总计\n      rules: {\n        schoolName: [\n          {\n            required: true,\n            message: \"学校名称必须输入\",\n            trigger: [\"blur\", \"change\"],\n          },\n        ],\n      },\n    };\n  },\n\n  components: {},\n  mounted(){\n    this.fetchSchool()\n  },\n\n  methods: {\n    addData(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          schoolApi.addSchool(this.school).then((response) => {\n            const resp = response.data;\n            console.log(resp,'res');\n            if (resp.status == 0) {\n              this.schoolFormVisible = false;\n              this.fetchSchool();\n              this.$message({\n                type: \"success\",\n                message: \"添加学校成功\",\n              });\n            }\n          });\n        } else {\n          console.log(\"error submit\", error);\n          return false;\n        }\n      });\n    },\n    updateData(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          schoolApi.updateSchool(this.school).then((response) => {\n            const resp = response.data;\n            if (resp.status == 0) {\n              this.schoolFormVisible = false;\n              this.fetchSchool();\n              this.$message({\n                type: \"success\",\n                message: \"更新学校成功\",\n              });\n            }\n          });\n        } else {\n          console.log(\"error submit\", error);\n          return false;\n        }\n      });\n    },\n    handleAdd() {\n      this.school={\n        _id:null,\n        schoolname:\"\"\n      }\n      this.schoolFormVisible = true;\n      this.$nextTick(() => {\n        this.$refs[\"schoolForm\"].resetFields();\n      });\n    },\n    handleEdit(_id) {\n      this.handleAdd();\n      schoolApi.getSchoolById(_id).then((response)=>{\n        const resp = response.data;\n        if(resp.status==0){\n          this.school = resp.data\n        }\n      })\n    },\n     handleDelete(_id) {\n      this.$confirm(\"确认删除该用户吗？\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n        .then(() => {\n          schoolApi.deleteSchoolById(_id).then((response) => {\n            const resp = response.data;\n            if (resp.status == 0) {\n              this.$message({\n                type: \"success\",\n                message: \"删除学校成功!\",\n              });\n              this.totalPage = (this.total - 1)/this.pageSize\n              this.fetchSchool();\n            }\n          });\n        }).catch(() => {});\n    },\n    handleSizeChange(val) {\n     this.pageSize=val\n      this.fetchSchool();\n    },\n    handleCurrentChange(val) {\n     this.currentPage=val\n      this.fetchSchool();\n    },\n    fetchSchool() {\n      if(this.currentPage > Math.ceil(this.totalPage)){\n        this.currentPage = Math.ceil(this.totalPage)\n      }\n      schoolApi\n        .getSchoolList(this.currentPage, this.pageSize)\n        .then((response) => {\n          const res = response.data;\n          console.log('------',res);\n          if (res.status == 0) {\n            this.schools = res.data.data;\n            this.total = res.data.total;\n             this.totalPage = this.total/this.pageSize\n          }\n        });\n    },\n  },\n};\n</script>\n\n<style scoped>\n</style>"]}]}