{"remainingRequest":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/babel-loader/lib/index.js!/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/liulei/Desktop/Vue/vue-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liulei/Desktop/Vue/vue-frontend/src/views/user/User.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liulei/Desktop/Vue/vue-frontend/src/views/user/User.vue","mtime":1658549813539},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/babel.config.js","mtime":1658195622849},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1657875963855},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/babel-loader/lib/index.js","mtime":1657875486856},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1657875963855},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/vue-loader/lib/index.js","mtime":1657875961434}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgdXNlckFwaSBmcm9tICJAL2FwaS91c2VyLmpzIjsKaW1wb3J0IHsgZm9ybWF0ZURhdGVMZXNzIH0gZnJvbSAiQC91dGlscy9kYXRlVXRpbHMiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHZhciB2YWxpZGF0YVVzZXJOYW1lID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICB2YWx1ZSA9IHZhbHVlLnRyaW0oKTsKICAgICAgY29uc3QgbGVuZ3RoID0gdmFsdWUgJiYgdmFsdWUubGVuZ3RoOwogICAgICBjb25zdCBwd2RSZWcgPSAvXlthLXpBLXowLTlfXSskLzsKCiAgICAgIGlmICh2YWx1ZSA9PT0gIiIpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIuivt+i+k+WFpei0puWPtyIpKTsKICAgICAgfSBlbHNlIGlmIChsZW5ndGggPCA0IHx8IGxlbmd0aCA+IDEyKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLplb/luqblnKg0LTEy5Liq5a2X56ym5LmL6Ze0IikpOwogICAgICB9IGVsc2UgaWYgKCFwd2RSZWcudGVzdCh2YWx1ZSkpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIui0puWPt+W/hemhu+eUseiLseaWh+OAgeWtl+avjeaIluS4i+WIkue6v+e7hOaIkCIpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjYWxsYmFjaygpOwogICAgICB9CiAgICB9OwoKICAgIHZhciB2YWxpZGF0YVBob25lID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICB2YWx1ZSA9IHZhbHVlLnRyaW0oKTsKICAgICAgY29uc3QgcHdkUmVnID0gL14oMTNbMC05XXwxNFswMTQ1Njg3OV18MTVbMC0zNS05XXwxNlsyNTY3XXwxN1swLThdfDE4WzAtOV18MTlbMC0zNS05XSlcZHs4fSQvOwoKICAgICAgaWYgKHZhbHVlID09PSAiIikgewogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi6K+36L6T5YWl5omL5py65Y+356CBIikpOwogICAgICB9IGVsc2UgaWYgKCFwd2RSZWcudGVzdCh2YWx1ZSkpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIuivt+i+k+WFpeato+ehruaJi+acuuWPt+eggSIpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjYWxsYmFjaygpOwogICAgICB9CiAgICB9OwoKICAgIHJldHVybiB7CiAgICAgIHVzZXJGb3JtVmlzaWJsZTogZmFsc2UsCiAgICAgIC8v57yW6L6R56qX5Y+j5piv5ZCm5pi+56S6CiAgICAgIHRvdGFsUGFnZTogMSwKICAgICAgdXNlcjogewogICAgICAgIC8v5paw5aKe5oiW57yW6L6R55So5oi35pWw5o2uCiAgICAgICAgX2lkOiBudWxsLAogICAgICAgIHVzZXJuYW1lOiAiIiwKICAgICAgICBwYXNzd29yZDogIiIsCiAgICAgICAgbmFtZTogIiIsCiAgICAgICAgcGhvbmU6ICIiLAogICAgICAgIHJvbGVfaWQ6ICIiCiAgICAgIH0sCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgdXNlcm5hbWU6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIHZhbGlkYXRvcjogdmFsaWRhdGFVc2VyTmFtZSwKICAgICAgICAgIHRyaWdnZXI6IFsiYmx1ciIsICJjaGFuZ2UiXQogICAgICAgIH1dLAogICAgICAgIHBob25lOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICB2YWxpZGF0b3I6IHZhbGlkYXRhUGhvbmUsCiAgICAgICAgICB0cmlnZ2VyOiBbImJsdXIiLCAiY2hhbmdlIl0KICAgICAgICB9XSwKICAgICAgICBwYXNzd29yZDogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIuivt+i+k+WFpeWvhueggSIsCiAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICB9LCB7CiAgICAgICAgICBtaW46IDQsCiAgICAgICAgICBtZXNzYWdlOiAi5a+G56CB6ZW/5bqm6ZyA5aSn5LqO562J5LqONOS9jSIsCiAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICB9XSwKICAgICAgICBuYW1lOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAi6K+36L6T5YWl5aeT5ZCNIiwKICAgICAgICAgIHRyaWdnZXI6ICJibHVyIgogICAgICAgIH1dLAogICAgICAgIHJvbGVfaWQ6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICLor7fpgInmi6nop5LoibIiLAogICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgfV0KICAgICAgfSwKICAgICAgcm9sZU9wdGlvbnM6IFtdLAogICAgICB1c2VyczogW10sCiAgICAgIHBhZ2VTaXplOiA1LAogICAgICAvL+avj+mhteaYvuekuuadoeaVsAogICAgICBjdXJyZW50UGFnZTogMSwKICAgICAgLy/lvZPliY3pobUKICAgICAgdG90YWw6IDAgLy/mgLvorqEKCiAgICB9OwogIH0sCgogIGNvbXBvbmVudHM6IHt9LAoKICBtb3VudGVkKCkgewogICAgdGhpcy5mZXRjaFVzZXJzKCk7CiAgfSwKCiAgbWV0aG9kczogewogICAgZmV0Y2hVc2VycygpIHsKICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgPiBNYXRoLmNlaWwodGhpcy50b3RhbFBhZ2UpKSB7CiAgICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IE1hdGguY2VpbCh0aGlzLnRvdGFsUGFnZSk7CiAgICAgIH0KCiAgICAgIHVzZXJBcGkuZ2V0VXNlckxpc3QodGhpcy5jdXJyZW50UGFnZSwgdGhpcy5wYWdlU2l6ZSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgY29uc3QgcmVzcCA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PT0gMCkgewogICAgICAgICAgdGhpcy51c2VycyA9IHJlc3AuZGF0YS5kYXRhOwogICAgICAgICAgdGhpcy5yb2xlT3B0aW9ucyA9IHJlc3AuZGF0YS5yb2xlczsKICAgICAgICAgIHRoaXMudG90YWwgPSByZXNwLmRhdGEudG90YWw7CiAgICAgICAgICB0aGlzLnRvdGFsUGFnZSA9IHRoaXMudG90YWwgLyB0aGlzLnBhZ2VTaXplOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIGhhbmRsZVNpemVDaGFuZ2UodmFsKSB7CiAgICAgIGNvbnNvbGUubG9nKGDmr4/pobUgJHt2YWx9IOadoWApOwogICAgICB0aGlzLnBhZ2VTaXplID0gdmFsOwogICAgICB0aGlzLmZldGNoVXNlcnMoKTsKICAgIH0sCgogICAgaGFuZGxlQ3VycmVudENoYW5nZSh2YWwpIHsKICAgICAgY29uc29sZS5sb2coYOW9k+WJjemhtTogJHt2YWx9YCk7CiAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSB2YWw7CiAgICAgIHRoaXMuZmV0Y2hVc2VycygpOwogICAgfSwKCiAgICBoYW5kbGVFZGl0KF9pZCkgewogICAgICB0aGlzLmhhbmRsZUFkZCgpOwogICAgICB1c2VyQXBpLmdldFVzZXJCeUlkKF9pZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgY29uc3QgcmVzcCA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICB0aGlzLnVzZXIgPSByZXNwLmRhdGE7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgaGFuZGxlRGVsZXRlKGlkKSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oIuehruiupOWIoOmZpOaUueeUqOaIt+WQl++8nyIsICLmj5DnpLoiLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICLnoa7lrpoiLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICLlj5bmtogiLAogICAgICAgIHR5cGU6ICJ3YXJuaW5nIgogICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICB1c2VyQXBpLmRlbGV0ZVVzZXJCeUlkKGlkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIGNvbnN0IHJlc3AgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICBtZXNzYWdlOiAi5Yig6Zmk5oiQ5YqfISIKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMudG90YWxQYWdlID0gKHRoaXMudG90YWwgLSAxKSAvIHRoaXMucGFnZVNpemU7CiAgICAgICAgICAgIHRoaXMuZmV0Y2hVc2VycygpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KS5jYXRjaCgoKSA9PiB7fSk7CiAgICB9LAoKICAgIHJlc2V0RGF0ZShyb3csIGNvbHVtbiwgY2VsbFZhbHVlLCBpbmRleCkgewogICAgICByZXR1cm4gZm9ybWF0ZURhdGVMZXNzKGNlbGxWYWx1ZSk7CiAgICB9LAoKICAgIGdlUm9sZShyb3csIGNvbHVtbiwgY2VsbFZhbHVlLCBpbmRleCkgewogICAgICByZXR1cm4gdGhpcy5yb2xlT3B0aW9ucy5maW5kKGl0ZW0gPT4gaXRlbS5faWQgPT09IGNlbGxWYWx1ZSkubmFtZTsKICAgIH0sCgogICAgLy/mt7vliqDnlKjmiLcKICAgIGFkZERhdGEoZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUodmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgdXNlckFwaS5hZGRVc2VyKHRoaXMudXNlcikudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHJlcyA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICAgICAgdGhpcy5mZXRjaFVzZXJzKCk7CiAgICAgICAgICAgICAgdGhpcy51c2VyRm9ybVZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICLmt7vliqDnlKjmiLfmiJDlip8iCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gLy/mlrDlop7miJDlip/vvIzliLfmlrDliJfooajmlbDmja4KCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIC8v5omT5byA55So5oi356qX5Y+jCiAgICBoYW5kbGVBZGQoKSB7CiAgICAgIHRoaXMudXNlciA9IHsKICAgICAgICBfaWQ6IG51bGwsCiAgICAgICAgdXNlcm5hbWU6ICIiLAogICAgICAgIHBhc3N3b3JkOiAiIiwKICAgICAgICBuYW1lOiAiIiwKICAgICAgICBwaG9uZTogIiIsCiAgICAgICAgcm9sZV9pZDogIiIKICAgICAgfSwgdGhpcy51c2VyRm9ybVZpc2libGUgPSB0cnVlOwogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy4kcmVmc1sidXNlckZvcm0iXS5yZXNldEZpZWxkcygpOwogICAgICB9KTsKICAgIH0sCgogICAgLy/mm7TmlrDnlKjmiLfmlbDmja4KICAgIHVwZGF0ZURhdGEoZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUodmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgdXNlckFwaS51cGRhdGVVc2VyKHRoaXMudXNlcikudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHJlcyA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICAgICAgdGhpcy5mZXRjaFVzZXJzKCk7CiAgICAgICAgICAgICAgdGhpcy51c2VyRm9ybVZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICLmm7TmlrDnlKjmiLfmlbDmja7miJDlip8iCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gLy/mlrDlop7miJDlip/vvIzliLfmlrDliJfooajmlbDmja4KCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogIH0KfTs="},{"version":3,"mappings":";AA8FA;AACA;AACA;EACAA;IACA;MACAC;MACA;MACA;;MACA;QACAC;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA;IACA,CAbA;;IAcA;MACAD;MACA,eACA,8EADA;;MAEA;QACAC;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA;IACA,CAXA;;IAYA;MACAC,sBADA;MACA;MACAC,YAFA;MAGAC;QACA;QACAC,SAFA;QAGAC,YAHA;QAIAC,YAJA;QAKAC,QALA;QAMAC,SANA;QAOAC;MAPA,CAHA;MAYAC;QACAL,WACA;UACAM,cADA;UAEAC,2BAFA;UAGAC;QAHA,CADA,CADA;QAQAL,QACA;UACAG,cADA;UAEAC,wBAFA;UAGAC;QAHA,CADA,CARA;QAeAP,WACA;UACAK,cADA;UAEAG,gBAFA;UAGAD;QAHA,CADA,EAMA;UACAE,MADA;UAEAD,sBAFA;UAGAD;QAHA,CANA,CAfA;QA2BAN,OACA;UACAI,cADA;UAEAG,gBAFA;UAGAD;QAHA,CADA,CA3BA;QAkCAJ,UACA;UACAE,cADA;UAEAG,gBAFA;UAGAD;QAHA,CADA;MAlCA,CAZA;MAsDAG,eAtDA;MAuDAC,SAvDA;MAwDAC,WAxDA;MAwDA;MACAC,cAzDA;MAyDA;MACAC,QA1DA,CA0DA;;IA1DA;EA4DA,CAxFA;;EA0FAC,cA1FA;;EA2FAC;IACA;EACA,CA7FA;;EA8FAC;IACAC;MACA;QACA;MACA;;MACAC;QACA;;QACA;UACA;UACA;UACA;UACA;QACA;MACA,CARA;IASA,CAdA;;IAeAC;MACAC;MACA;MACA;IACA,CAnBA;;IAoBAC;MACAD;MACA;MACA;IACA,CAxBA;;IAyBAE;MACA;MACAJ;QACA;;QACA;UACA;QACA;MACA,CALA;IAMA,CAjCA;;IAkCAK;MACA;QACAC,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAKAC,IALA,CAKA;QACAT;UACA;;UACA;YACA;cACAQ,eADA;cAEAnB;YAFA;YAIA;YACA;UACA;QAEA,CAXA;MAYA,CAlBA,EAkBAqB,KAlBA,CAkBA,QAlBA;IAmBA,CAtDA;;IAuDAC;MACA;IACA,CAzDA;;IA0DAC;MACA;IACA,CA5DA;;IA6DA;IACAC;MACA;QACA;UACAb;YACA;;YACA;cACA;cACA;cACA;gBACAQ,eADA;gBAEAnB;cAFA;YAIA,CATA,CAWA;;UACA,CAZA;QAaA,CAdA,MAcA;UACA;QACA;MACA,CAlBA;IAmBA,CAlFA;;IAmFA;IACAyB;MACA;QACAnC,SADA;QAEAC,YAFA;QAGAC,YAHA;QAIAC,QAJA;QAKAC,SALA;QAMAC;MANA,GAQA,2BARA;MASA;QACA;MACA,CAFA;IAGA,CAjGA;;IAkGA;IACA+B;MACA;QACA;UACAf;YACA;;YACA;cACA;cACA;cACA;gBACAQ,eADA;gBAEAnB;cAFA;YAIA,CATA,CAUA;;UACA,CAXA;QAYA,CAbA,MAaA;UACA;QACA;MACA,CAjBA;IAkBA;;EAtHA;AA9FA","names":["data","value","callback","userFormVisible","totalPage","user","_id","username","password","name","phone","role_id","rules","required","validator","trigger","message","min","roleOptions","users","pageSize","currentPage","total","components","mounted","methods","fetchUsers","userApi","handleSizeChange","console","handleCurrentChange","handleEdit","handleDelete","confirmButtonText","cancelButtonText","type","then","catch","resetDate","geRole","addData","handleAdd","updateData"],"sourceRoot":"src/views/user","sources":["User.vue"],"sourcesContent":["<template>\n  <div>\n    <div style=\"margin: 20px 0\">\n      <el-button type=\"primary\" @click=\"handleAdd\">添加用户</el-button>\n    </div>\n    <el-table :data=\"users\" heigth=\"380\" border style=\"width: 100%\">\n      <el-table-column label=\"序号\" width=\"60\" type=\"index\"></el-table-column>\n      <el-table-column label=\"用户名\" prop=\"username\"></el-table-column>\n      <el-table-column label=\"姓名\" prop=\"name\"></el-table-column>\n      <el-table-column label=\"电话\" prop=\"phone\"></el-table-column>\n      <el-table-column\n        label=\"创建时间\"\n        prop=\"create_time\"\n        :formatter=\"resetDate\"\n      ></el-table-column>\n      <el-table-column label=\"所属角色\" prop=\"role_id\" :formatter=\"geRole\"></el-table-column>\n      <el-table-column label=\"操作\" width=\"250\">\n        <template slot-scope=\"scope\">\n          <el-button size=\"mini\" @click=\"handleEdit(scope.row._id)\"\n            >编辑</el-button\n          >\n          <el-button\n            size=\"mini\"\n            type=\"danger\"\n            @click=\"handleDelete(scope.row._id)\"\n            >删除</el-button\n          >\n        </template>\n      </el-table-column>\n    </el-table>\n    <el-pagination\n      @size-change=\"handleSizeChange\"\n      @current-change=\"handleCurrentChange\"\n      :current-page=\"currentPage\"\n      :page-sizes=\"[5, 10, 15, 20]\"\n      :page-size=\"pageSize\"\n      layout=\"total, sizes, prev, pager, next, jumper\"\n      :total=\"total\"\n    >\n    </el-pagination>\n    <!-- 添加用户表单 -->\n    <el-dialog title=\"添加用户\" :visible.sync=\"userFormVisible\" width=\"500px\">\n      <el-form\n        status-icon\n        :model=\"user\"\n        ref=\"userForm\"\n        label-width=\"100px\"\n        label-position=\"right\"\n        style=\"width: 400px\"\n        :rules=\"rules\"\n      >\n        <el-form-item label=\"用户名\" prop=\"username\">\n          <el-input v-model=\"user.username\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"密码\" prop=\"password\">\n          <el-input v-model=\"user.password\" type=\"password\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"姓名\" prop=\"name\">\n          <el-input v-model=\"user.name\" palceholder=\"请输入姓名\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"角色\" prop=\"role_id\">\n          <el-select\n            v-model=\"user.role_id\"\n            class=\"filter-item\"\n            placeholder=\"请点击选择\"\n          >\n            <el-option\n              v-for=\"option in roleOptions\"\n              :key=\"option._id\"\n              :label=\"option.name\"\n              :value=\"option._id\"\n            >\n            </el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"手机号码\" prop=\"phone\">\n          <el-input v-model=\"user.phone\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"userFormVisible = false\">取 消</el-button>\n        <el-button\n          type=\"primary\"\n          @click=\"\n            user._id == null ? addData('userForm') : updateData('userForm')\n          \"\n          >确 定</el-button\n        >\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport userApi from \"@/api/user.js\";\nimport { formateDateLess } from \"@/utils/dateUtils\";\nexport default {\n  data() {\n    var validataUserName = (rule, value, callback) => {\n      value = value.trim();\n      const length = value && value.length;\n      const pwdReg = /^[a-zA-z0-9_]+$/;\n      if (value === \"\") {\n        callback(new Error(\"请输入账号\"));\n      } else if (length < 4 || length > 12) {\n        callback(new Error(\"长度在4-12个字符之间\"));\n      } else if (!pwdReg.test(value)) {\n        callback(new Error(\"账号必须由英文、字母或下划线组成\"));\n      } else {\n        callback();\n      }\n    };\n    var validataPhone = (rule, value, callback) => {\n      value = value.trim();\n      const pwdReg =\n        /^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\\d{8}$/;\n      if (value === \"\") {\n        callback(new Error(\"请输入手机号码\"));\n      } else if (!pwdReg.test(value)) {\n        callback(new Error(\"请输入正确手机号码\"));\n      } else {\n        callback();\n      }\n    };\n    return {\n      userFormVisible: false, //编辑窗口是否显示\n      totalPage:1,\n      user: {\n        //新增或编辑用户数据\n        _id: null,\n        username: \"\",\n        password: \"\",\n        name: \"\",\n        phone: \"\",\n        role_id: \"\",\n      },\n      rules: {\n        username: [\n          {\n            required: true,\n            validator: validataUserName,\n            trigger: [\"blur\", \"change\"],\n          },\n        ],\n        phone: [\n          {\n            required: true,\n            validator: validataPhone,\n            trigger: [\"blur\", \"change\"],\n          },\n        ],\n        password: [\n          {\n            required: true,\n            message: \"请输入密码\",\n            trigger: \"blur\",\n          },\n          {\n            min: 4,\n            message: \"密码长度需大于等于4位\",\n            trigger: \"blur\",\n          },\n        ],\n        name: [\n          {\n            required: true,\n            message: \"请输入姓名\",\n            trigger: \"blur\",\n          },\n        ],\n        role_id: [\n          {\n            required: true,\n            message: \"请选择角色\",\n            trigger: \"blur\",\n          },\n        ],\n      },\n      roleOptions: [],\n      users: [],\n      pageSize: 5, //每页显示条数\n      currentPage: 1, //当前页\n      total: 0, //总计\n    };\n  },\n\n  components: {},\n  mounted() {\n    this.fetchUsers();\n  },\n  methods: {\n    fetchUsers() {\n      if(this.currentPage > Math.ceil(this.totalPage)){\n        this.currentPage = Math.ceil(this.totalPage)\n      }\n      userApi.getUserList(this.currentPage, this.pageSize).then((response) => {\n        const resp = response.data;\n        if (resp.status === 0) {\n          this.users = resp.data.data;\n          this.roleOptions = resp.data.roles;\n          this.total = resp.data.total;\n          this.totalPage = this.total/this.pageSize\n        }\n      });\n    },\n    handleSizeChange(val) {\n      console.log(`每页 ${val} 条`);\n      this.pageSize=val\n       this.fetchUsers();\n    },\n    handleCurrentChange(val) {\n      console.log(`当前页: ${val}`);\n      this.currentPage=val\n       this.fetchUsers();\n    },\n    handleEdit(_id) {\n      this.handleAdd();\n      userApi.getUserById(_id).then((response) => {\n        const resp = response.data;\n        if (resp.status == 0) {\n          this.user = resp.data;\n        }\n      });\n    },\n    handleDelete(id) {\n      this.$confirm(\"确认删除改用户吗？\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n        .then(() => {\n          userApi.deleteUserById(id).then((response) => {\n            const resp = response.data;\n            if (resp.status == 0) {\n              this.$message({\n                type: \"success\",\n                message: \"删除成功!\",\n              });\n              this.totalPage = (this.total - 1)/this.pageSize\n              this.fetchUsers();\n            }\n          \n          });\n        }).catch(() => {});\n    },\n    resetDate(row, column, cellValue, index) {\n      return formateDateLess(cellValue);\n    },\n    geRole(row,column,cellValue,index){\n      return  this.roleOptions.find(item=>item._id===cellValue).name\n    },\n    //添加用户\n    addData(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          userApi.addUser(this.user).then((response) => {\n            const res = response.data;\n            if (res.status == 0) {\n              this.fetchUsers();\n              this.userFormVisible = false;\n              this.$message({\n                type: \"success\",\n                message: \"添加用户成功\",\n              });\n            }\n\n            //新增成功，刷新列表数据\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    //打开用户窗口\n    handleAdd() {\n      (this.user = {\n        _id: null,\n        username: \"\",\n        password: \"\",\n        name: \"\",\n        phone: \"\",\n        role_id: \"\",\n      }),\n        (this.userFormVisible = true);\n      this.$nextTick(() => {\n        this.$refs[\"userForm\"].resetFields();\n      });\n    },\n    //更新用户数据\n    updateData(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          userApi.updateUser(this.user).then((response) => {\n            const res = response.data;\n            if (res.status == 0) {\n              this.fetchUsers();\n              this.userFormVisible = false;\n              this.$message({\n                type: \"success\",\n                message: \"更新用户数据成功\",\n              });\n            }\n            //新增成功，刷新列表数据\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style scoped>\n</style>"]}]}