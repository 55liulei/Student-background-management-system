{"remainingRequest":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/babel-loader/lib/index.js!/Users/liulei/Desktop/Vue/vue-frontend/src/utils/request.js","dependencies":[{"path":"/Users/liulei/Desktop/Vue/vue-frontend/src/utils/request.js","mtime":1659058093639},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/babel.config.js","mtime":1658195622849},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1657875963855},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/babel-loader/lib/index.js","mtime":1657875486856}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IG1lbW9yeVV0aWxzIGZyb20gJy4vbWVtb3J5VXRpbHMnOwppbXBvcnQgeyBNZXNzYWdlLCBMb2FkaW5nIH0gZnJvbSAnZWxlbWVudC11aSc7CmltcG9ydCBzdG9yYWdlVXRpbHMgZnJvbSAnQC91dGlscy9zdG9yYWdlVXRpbHMuanMnOwpjb25zdCByZXF1ZXN0ID0gYXhpb3MuY3JlYXRlKHsKICBiYXNlVVJMOiBwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfQVBJLAogIHRpbWVvdXQ6IDUwMDAKfSk7CmNvbnN0IGxvYWRpbmcgPSB7CiAgbG9hZGluZ0luc3RhbmNlOiBudWxsLAogIG9wZW46IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLmxvYWRpbmdJbnN0YW5jZSA9PSBudWxsKSB7CiAgICAgIHRoaXMubG9hZGluZ0luc3RhbmNlID0gTG9hZGluZy5zZXJ2aWNlKHsKICAgICAgICB0ZXh0OiAn5ou85ZG95Yqg6L295LitLi4uLicsCiAgICAgICAgdGFyZ2V0OiAnLm1haW4nLAogICAgICAgIGJhY2tncm91bmQ6ICdyZ2JhKDAsMCwwLDAuNSknCiAgICAgIH0pOwogICAgfQogIH0sCiAgY2xvc2U6IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLmxvYWRpbmdJbnN0YW5jZSAhPT0gbnVsbCkgewogICAgICB0aGlzLmxvYWRpbmdJbnN0YW5jZS5jbG9zZSgpOwogICAgfQoKICAgIHRoaXMubG9hZGluZ0luc3RhbmNlID0gbnVsbDsKICB9Cn07Cgpjb25zdCBnZXRNZW51cyA9ICgpID0+IHsKICBpZiAobWVtb3J5VXRpbHMudXNlci5yb2xlX2lkKSB7CiAgICAvL+iOt+WPlue8k+WtmOaVsOaNruS4reeahOinkuiJsmlk5Y+K5p2D6ZmQ5pWw57uECiAgICBjb25zdCByb2xlSWQgPSBtZW1vcnlVdGlscy51c2VyLnJvbGVfaWQ7CiAgICBjb25zdCB1c2VyTWVudXMgPSBtZW1vcnlVdGlscy51c2VyLnJvbGUubWVudXM7CiAgICByZXF1ZXN0KHsKICAgICAgdXJsOiAnL21lbnVzJywKICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgIGRhdGE6IHsKICAgICAgICByb2xlSWQKICAgICAgfQogICAgfSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgIGNvbnN0IHJlc3AgPSByZXNwb25zZS5kYXRhOwoKICAgICAgaWYgKHJlc3Auc3RhdHVzID09PSAwKSB7CiAgICAgICAgLy/mnIDmlrDmnYPpmZDmlbDnu4QKICAgICAgICBjb25zdCBtZW51cyA9IHJlc3AuZGF0YS5tZW51czsKCiAgICAgICAgaWYgKHVzZXJNZW51cy5sZW5ndGggPT09IG1lbnVzLmxlbmd0aCkgewogICAgICAgICAgdXNlck1lbnVzLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgIGlmIChtZW51cy5pbmRleE9mKGl0ZW0pID09PSAtMSkgewogICAgICAgICAgICAgIG1lbW9yeVV0aWxzLnVzZXIgPSB7fTsKICAgICAgICAgICAgICBzdG9yYWdlVXRpbHMucmVtb3ZlVXNlcigpOwogICAgICAgICAgICAgIE1lc3NhZ2UoewogICAgICAgICAgICAgICAgbWVzc2FnZTogIuW9k+WJjeeUqOaIt+adg+mZkOiiq+S/ruaUue+8jOivt+mHjeaWsOeZu+W9lSIsCiAgICAgICAgICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZSA9ICcvbG9naW4nOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbWVtb3J5VXRpbHMudXNlciA9IHt9OwogICAgICAgICAgc3RvcmFnZVV0aWxzLnJlbW92ZVVzZXIoKTsKICAgICAgICAgIE1lc3NhZ2UoewogICAgICAgICAgICBtZXNzYWdlOiAi5b2T5YmN55So5oi35p2D6ZmQ6KKr5L+u5pS577yM6K+36YeN5paw55m75b2VIiwKICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgICB9KTsKICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlID0gJy9sb2dpbic7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm47CiAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICByZXR1cm47CiAgICB9KTsKICB9Cn07IC8vIOivt+axguaLpuaIquWZqAoKCnJlcXVlc3QuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKGNvbmZpZyA9PiB7CiAgaWYgKGNvbmZpZy51cmwgIT09ICcvbWVudXMnKSB7CiAgICBsb2FkaW5nLm9wZW4oKTsKICAgIGdldE1lbnVzKCk7CiAgfSAvLyDor7fmsYLmi6bmiKoKCgogIHJldHVybiBjb25maWc7Cn0sIGVycm9yID0+IHsKICAvLyDlh7rnjrDlvILluLjvvIzmipvlh7rplJnor6/lr7kKICBsb2FkaW5nLmNsb3NlKCk7CiAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKfSk7IC8vIOWTjeW6lOaLpuaIquWZqAoKcmVxdWVzdC5pbnRlcmNlcHRvcnMucmVzcG9uc2UudXNlKHJlc3BvbnNlID0+IHsKICBsb2FkaW5nLmNsb3NlKCk7CiAgY29uc3QgcmVzcCA9IHJlc3BvbnNlLmRhdGE7CgogIGlmIChyZXNwLnN0YXR1cyAhPT0gMCkgewogICAgTWVzc2FnZSh7CiAgICAgIG1lc3NhZ2U6IHJlc3AubXNnIHx8ICfns7vnu5/lvILluLgnLAogICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgIGR1cmF0aW9uOiA1ICogMTAwMAogICAgfSk7CiAgfQoKICByZXR1cm4gcmVzcG9uc2U7Cn0sIGVycm9yID0+IHsKICBsb2FkaW5nLmNsb3NlKCk7CiAgTWVzc2FnZSh7CiAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLAogICAgdHlwZTogImVycm9yIiwKICAgIGR1cmF0aW9uOiA1ICogMTAwMAogIH0pOwogIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7Cn0pOwpleHBvcnQgZGVmYXVsdCByZXF1ZXN0Ow=="},{"version":3,"names":["axios","memoryUtils","Message","Loading","storageUtils","request","create","baseURL","process","env","VUE_APP_BASE_API","timeout","loading","loadingInstance","open","service","text","target","background","close","getMenus","user","role_id","roleId","userMenus","role","menus","url","method","data","then","response","resp","status","length","forEach","item","indexOf","removeUser","message","type","window","location","replace","catch","err","interceptors","use","config","error","Promise","reject","msg","duration"],"sources":["/Users/liulei/Desktop/Vue/vue-frontend/src/utils/request.js"],"sourcesContent":["import axios from 'axios'\r\nimport memoryUtils from './memoryUtils'\r\nimport { Message, Loading } from 'element-ui'\r\nimport storageUtils from '@/utils/storageUtils.js'\r\nconst request = axios.create({\r\n    baseURL: process.env.VUE_APP_BASE_API,\r\n    timeout: 5000\r\n})\r\nconst loading = {\r\n    loadingInstance: null,\r\n    open: function () {\r\n        if (this.loadingInstance == null) {\r\n            this.loadingInstance = Loading.service({\r\n                text: '拼命加载中....',\r\n                target: '.main',\r\n                background: 'rgba(0,0,0,0.5)'\r\n            })\r\n        }\r\n    },\r\n    close: function () {\r\n        if (this.loadingInstance !== null) {\r\n            this.loadingInstance.close()\r\n        }\r\n        this.loadingInstance = null\r\n    }\r\n}\r\nconst getMenus = () => {\r\n    if (memoryUtils.user.role_id) {\r\n        //获取缓存数据中的角色id及权限数组\r\n        const roleId = memoryUtils.user.role_id;\r\n        const userMenus = memoryUtils.user.role.menus;\r\n        request({\r\n            url: '/menus',\r\n            method: 'post',\r\n            data: { roleId }\r\n        }).then(response => {\r\n            const resp = response.data;\r\n            if (resp.status === 0) {\r\n                //最新权限数组\r\n                const menus = resp.data.menus;\r\n                if (userMenus.length === menus.length) {\r\n                    userMenus.forEach(item => {\r\n                        if (menus.indexOf(item) === -1) {\r\n                            memoryUtils.user = {}\r\n                            storageUtils.removeUser();\r\n                            Message({\r\n                                message: \"当前用户权限被修改，请重新登录\",\r\n                                type: 'warning'\r\n                            })\r\n                            window.location.replace = '/login'\r\n                        }\r\n                    })\r\n                } else {\r\n                    memoryUtils.user = {};\r\n                    storageUtils.removeUser();\r\n                    Message({\r\n                        message: \"当前用户权限被修改，请重新登录\",\r\n                        type: 'warning'\r\n                    })\r\n                    window.location.replace = '/login'\r\n                }\r\n            }\r\n            return\r\n        }).catch(err => {\r\n            return\r\n        })\r\n    }\r\n}\r\n// 请求拦截器\r\nrequest.interceptors.request.use(config => {\r\n\r\n    if (config.url !== '/menus') {\r\n        loading.open()\r\n        getMenus()\r\n    }\r\n    // 请求拦截\r\n    return config\r\n}, error => {\r\n    // 出现异常，抛出错误对\r\n    loading.close()\r\n    return Promise.reject(error)\r\n})\r\n\r\n// 响应拦截器\r\nrequest.interceptors.response.use(response => {\r\n    loading.close()\r\n    const resp = response.data;\r\n    if (resp.status !== 0) {\r\n        Message({\r\n            message: resp.msg || '系统异常',\r\n            type: \"warning\",\r\n            duration: 5 * 1000\r\n        })\r\n    }\r\n    return response\r\n}, error => {\r\n    loading.close()\r\n    Message({\r\n        message: error.message,\r\n        type: \"error\",\r\n        duration: 5 * 1000\r\n    })\r\n    return Promise.reject(error)\r\n})\r\n\r\nexport default request"],"mappings":"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"}]}