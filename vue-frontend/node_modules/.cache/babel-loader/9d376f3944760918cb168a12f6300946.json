{"remainingRequest":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/babel-loader/lib/index.js!/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/liulei/Desktop/Vue/vue-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liulei/Desktop/Vue/vue-frontend/src/views/students/Major.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liulei/Desktop/Vue/vue-frontend/src/views/students/Major.vue","mtime":1658735789310},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/babel.config.js","mtime":1658195622849},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1657875963855},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/babel-loader/lib/index.js","mtime":1657875486856},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1657875963855},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/vue-loader/lib/index.js","mtime":1657875961434}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IG1ham9yQXBpIGZyb20gIkAvYXBpL21ham9yLmpzIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBtYWpvckZvcm1WaXNpYmxlOiBmYWxzZSwKICAgICAgLy/nvJbovpHnqpflj6PmmK/lkKbmmL7npLoKICAgICAgbWFqb3I6IHsKICAgICAgICBfaWQ6IG51bGwsCiAgICAgICAgbmFtZTogIiIKICAgICAgfSwKICAgICAgbWFqb3JzOiBbXSwKICAgICAgdG90YWxQYWdlOiAxLAogICAgICBwYWdlU2l6ZTogNSwKICAgICAgLy/mr4/pobXmmL7npLrmnaHmlbAKICAgICAgY3VycmVudFBhZ2U6IDEsCiAgICAgIC8v5b2T5YmN6aG1CiAgICAgIHRvdGFsOiAwLAogICAgICAvL+aAu+iuoQogICAgICBydWxlczogewogICAgICAgIG1ham9yTmFtZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIuS4k+S4muWQjeensOW/hemhu+i+k+WFpSIsCiAgICAgICAgICB0cmlnZ2VyOiBbImJsdXIiLCAiY2hhbmdlIl0KICAgICAgICB9XQogICAgICB9CiAgICB9OwogIH0sCgogIGNvbXBvbmVudHM6IHt9LAoKICBtb3VudGVkKCkgewogICAgdGhpcy5mZXRjaE1ham9yKCk7CiAgfSwKCiAgbWV0aG9kczogewogICAgYWRkRGF0YShmb3JtTmFtZSkgewogICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS52YWxpZGF0ZSh2YWxpZCA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBtYWpvckFwaS5hZGRNYWpvcih0aGlzLm1ham9yKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgY29uc3QgcmVzcCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3AsICdyZXMnKTsKCiAgICAgICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICAgICAgdGhpcy5tYWpvckZvcm1WaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy5mZXRjaE1ham9yKCk7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5re75Yqg5LiT5Lia5oiQ5YqfIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coImVycm9yIHN1Ym1pdCIsIGVycm9yKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICB1cGRhdGVEYXRhKGZvcm1OYW1lKSB7CiAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnZhbGlkYXRlKHZhbGlkID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIG1ham9yQXBpLnVwZGF0ZU1ham9yKHRoaXMubWFqb3IpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICBjb25zdCByZXNwID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICAgICAgdGhpcy5tYWpvckZvcm1WaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy5mZXRjaE1ham9yKCk7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5pu05paw5LiT5Lia5oiQ5YqfIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coImVycm9yIHN1Ym1pdCIsIGVycm9yKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBoYW5kbGVBZGQoKSB7CiAgICAgIHRoaXMubWFqb3IgPSB7CiAgICAgICAgX2lkOiBudWxsLAogICAgICAgIG5hbWU6ICIiCiAgICAgIH07CiAgICAgIHRoaXMubWFqb3JGb3JtVmlzaWJsZSA9IHRydWU7CiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICB0aGlzLiRyZWZzWyJtYWpvckZvcm0iXS5yZXNldEZpZWxkcygpOwogICAgICB9KTsKICAgIH0sCgogICAgaGFuZGxlRWRpdChfaWQpIHsKICAgICAgdGhpcy5oYW5kbGVBZGQoKTsKICAgICAgbWFqb3JBcGkuZ2V0TWFqb3JCeUlkKF9pZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgY29uc3QgcmVzcCA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICB0aGlzLm1ham9yID0gcmVzcC5kYXRhOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIGhhbmRsZURlbGV0ZShfaWQpIHsKICAgICAgdGhpcy4kY29uZmlybSgi56Gu6K6k5Yig6Zmk5pS555So5oi35ZCX77yfIiwgIuaPkOekuiIsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIuehruWumiIsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogIuWPlua2iCIsCiAgICAgICAgdHlwZTogIndhcm5pbmciCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIG1ham9yQXBpLmRlbGV0ZU1ham9yQnlJZChfaWQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgY29uc3QgcmVzcCA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgICAgaWYgKHJlc3Auc3RhdHVzID09IDApIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgIG1lc3NhZ2U6ICLliKDpmaTkuJPkuJrmiJDlip8hIgogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy50b3RhbFBhZ2UgPSAodGhpcy50b3RhbCAtIDEpIC8gdGhpcy5wYWdlU2l6ZTsKICAgICAgICAgICAgdGhpcy5mZXRjaE1ham9yKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pLmNhdGNoKCgpID0+IHt9KTsKICAgIH0sCgogICAgaGFuZGxlU2l6ZUNoYW5nZSh2YWwpIHsKICAgICAgdGhpcy5wYWdlU2l6ZSA9IHZhbDsKICAgICAgdGhpcy5mZXRjaE1ham9yKCk7CiAgICB9LAoKICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UodmFsKSB7CiAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSB2YWw7CiAgICAgIHRoaXMuZmV0Y2hNYWpvcigpOwogICAgfSwKCiAgICBmZXRjaE1ham9yKCkgewogICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSA+IE1hdGguY2VpbCh0aGlzLnRvdGFsUGFnZSkpIHsKICAgICAgICB0aGlzLmN1cnJlbnRQYWdlID0gTWF0aC5jZWlsKHRoaXMudG90YWxQYWdlKTsKICAgICAgfQoKICAgICAgbWFqb3JBcGkuZ2V0TWFqb3JMaXN0KHRoaXMuY3VycmVudFBhZ2UsIHRoaXMucGFnZVNpemUpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGNvbnN0IHJlcyA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgY29uc29sZS5sb2coJy0tLS0tLScsIHJlcyk7CgogICAgICAgIGlmIChyZXMuc3RhdHVzID09IDApIHsKICAgICAgICAgIHRoaXMubWFqb3JzID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICAgIHRoaXMudG90YWwgPSByZXMuZGF0YS50b3RhbDsKICAgICAgICAgIHRoaXMudG90YWxQYWdlID0gdGhpcy50b3RhbCAvIHRoaXMucGFnZVNpemU7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgfQp9Ow=="},{"version":3,"mappings":"AAwEA;AACA;EACAA;IACA;MACAC,uBADA;MACA;MACAC;QACAC,SADA;QAEAC;MAFA,CAFA;MAMAC,UANA;MAOAC,YAPA;MAQAC,WARA;MAQA;MACAC,cATA;MASA;MACAC,QAVA;MAUA;MACAC;QACAC,YACA;UACAC,cADA;UAEAC,mBAFA;UAGAC;QAHA,CADA;MADA;IAXA;EAqBA,CAvBA;;EAwBAC,cAxBA;;EAyBAC;IACA;EACA,CA3BA;;EA6BAC;IACAC;MACA;QACA;UACAC;YACA;YACAC;;YACA;cACA;cACA;cACA;gBACAC,eADA;gBAEAR;cAFA;YAIA;UACA,CAXA;QAYA,CAbA,MAaA;UACAO;UACA;QACA;MACA,CAlBA;IAmBA,CArBA;;IAsBAE;MACA;QACA;UACAH;YACA;;YACA;cACA;cACA;cACA;gBACAE,eADA;gBAEAR;cAFA;YAIA;UACA,CAVA;QAWA,CAZA,MAYA;UACAO;UACA;QACA;MACA,CAjBA;IAkBA,CAzCA;;IA0CAG;MACA;QACApB,SADA;QAEAC;MAFA;MAIA;MACA;QACA;MACA,CAFA;IAGA,CAnDA;;IAoDAoB;MACA;MACAL;QACA;;QACA;UACA;QACA;MACA,CALA;IAMA,CA5DA;;IA6DAM;MACA;QACAC,uBADA;QAEAC,sBAFA;QAGAN;MAHA,GAKAO,IALA,CAKA;QACAT;UACA;;UACA;YACA;cACAE,eADA;cAEAR;YAFA;YAIA;YACA;UACA;QACA,CAVA;MAWA,CAjBA,EAiBAgB,KAjBA,CAiBA,QAjBA;IAkBA,CAhFA;;IAiFAC;MACA;MACA;IACA,CApFA;;IAqFAC;MACA;MACA;IACA,CAxFA;;IAyFAC;MACA;QACA;MACA;;MACAb,SACAc,YADA,CACA,gBADA,EACA,aADA,EAEAL,IAFA,CAEAM;QACA;QACAd;;QACA;UACA;UACA;UACA;QACA;MACA,CAVA;IAWA;;EAxGA;AA7BA","names":["data","majorFormVisible","major","_id","name","majors","totalPage","pageSize","currentPage","total","rules","majorName","required","message","trigger","components","mounted","methods","addData","majorApi","console","type","updateData","handleAdd","handleEdit","handleDelete","confirmButtonText","cancelButtonText","then","catch","handleSizeChange","handleCurrentChange","fetchMajor","getMajorList","response"],"sourceRoot":"src/views/students","sources":["Major.vue"],"sourcesContent":["<template>\n  <div>\n    <div style=\"margin: 20px\" class=\"btn_bos\">\n      <el-button type=\"primary\" @click=\"handleAdd\">添加专业</el-button>\n    </div>\n    <el-table :data=\"majors\" height=\"380\" border style=\"width: 100%\">\n      <el-table-column label=\"序号\" type=\"index\" width=\"60\"></el-table-column>\n      <el-table-column label=\"专业名称\" prop=\"name\"></el-table-column>\n      <el-table-column label=\"操作\" width=\"250\">\n        <template slot-scope=\"scope\">\n          <el-button size=\"mini\" @click=\"handleEdit(scope.row._id)\"\n            >编辑</el-button\n          >\n          <el-button\n            size=\"mini\"\n            type=\"danger\"\n            @click=\"handleDelete(scope.row._id)\"\n            >删除</el-button\n          >\n        </template>\n      </el-table-column>\n    </el-table>\n    <el-dialog\n      title=\"添加/编辑\"\n      :visible.sync=\"majorFormVisible\"\n      width=\"500px\"\n    >\n      <el-form\n        status-icon\n        :model=\"major\"\n        ref=\"majorForm\"\n        label-width=\"100px\"\n        label-position=\"right\"\n        style=\"width: 400px\"\n        :rules=\"rules\"\n      >\n        <el-form-item label=\"专业名称\" prop=\"name\">\n          <el-input\n            v-model=\"major.name\"\n            placeholder=\"请输入专业名称\"\n          ></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"majorFormVisible = false\">取 消</el-button>\n        <el-button\n          type=\"primary\"\n          @click=\"\n            major._id == null\n              ? addData('majorForm')\n              : updateData('majorForm')\n          \"\n          >确 定</el-button\n        >\n      </div>\n    </el-dialog>\n    <div>\n      <el-pagination\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n        :current-page=\"currentPage\"\n        :page-sizes=\"[5, 10, 15, 20]\"\n        :page-size=\"pageSize\"\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"total\"\n      >\n      </el-pagination>\n    </div>\n  </div>\n</template>\n\n<script>\nimport majorApi from \"@/api/major.js\";\nexport default {\n  data() {\n    return {\n      majorFormVisible: false, //编辑窗口是否显示\n      major: {\n        _id: null,\n        name: \"\",\n      },\n      majors:[],\n      totalPage:1,\n      pageSize: 5, //每页显示条数\n      currentPage: 1, //当前页\n      total: 0, //总计\n      rules: {\n        majorName: [\n          {\n            required: true,\n            message: \"专业名称必须输入\",\n            trigger: [\"blur\", \"change\"],\n          },\n        ],\n      },\n    };\n  },\n  components: {},\n  mounted(){\n    this.fetchMajor()\n  },\n\n  methods: {\n    addData(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          majorApi.addMajor(this.major).then((response) => {\n            const resp = response.data;\n            console.log(resp,'res');\n            if (resp.status == 0) {\n              this.majorFormVisible = false;\n              this.fetchMajor();\n              this.$message({\n                type: \"success\",\n                message: \"添加专业成功\",\n              });\n            }\n          });\n        } else {\n          console.log(\"error submit\", error);\n          return false;\n        }\n      });\n    },\n    updateData(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          majorApi.updateMajor(this.major).then((response) => {\n            const resp = response.data;\n            if (resp.status == 0) {\n              this.majorFormVisible = false;\n              this.fetchMajor();\n              this.$message({\n                type: \"success\",\n                message: \"更新专业成功\",\n              });\n            }\n          });\n        } else {\n          console.log(\"error submit\", error);\n          return false;\n        }\n      });\n    },\n    handleAdd() {\n      this.major={\n        _id:null,\n        name:\"\"\n      }\n      this.majorFormVisible = true;\n      this.$nextTick(() => {\n        this.$refs[\"majorForm\"].resetFields();\n      });\n    },\n    handleEdit(_id) {\n      this.handleAdd();\n      majorApi.getMajorById(_id).then((response)=>{\n        const resp = response.data;\n        if(resp.status==0){\n          this.major = resp.data\n        }\n      })\n    },\n     handleDelete(_id) {\n      this.$confirm(\"确认删除改用户吗？\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n        .then(() => {\n          majorApi.deleteMajorById(_id).then((response) => {\n            const resp = response.data;\n            if (resp.status == 0) {\n              this.$message({\n                type: \"success\",\n                message: \"删除专业成功!\",\n              });\n              this.totalPage = (this.total - 1)/this.pageSize\n              this.fetchMajor();\n            }\n          });\n        }).catch(() => {});\n    },\n    handleSizeChange(val) {\n     this.pageSize=val\n      this.fetchMajor();\n    },\n    handleCurrentChange(val) {\n     this.currentPage=val\n      this.fetchMajor();\n    },\n    fetchMajor() {\n      if(this.currentPage > Math.ceil(this.totalPage)){\n        this.currentPage = Math.ceil(this.totalPage)\n      }\n      majorApi\n        .getMajorList(this.currentPage, this.pageSize)\n        .then((response) => {\n          const res = response.data;\n          console.log('------',res);\n          if (res.status == 0) {\n            this.majors = res.data.data;\n            this.total = res.data.total;\n             this.totalPage = this.total/this.pageSize\n          }\n        });\n    },\n  },\n};\n</script>\n\n<style scoped>\n</style>"]}]}