{"remainingRequest":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/babel-loader/lib/index.js!/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/liulei/Desktop/Vue/vue-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liulei/Desktop/Vue/vue-frontend/src/views/students/Class.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liulei/Desktop/Vue/vue-frontend/src/views/students/Class.vue","mtime":1658734717309},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/babel.config.js","mtime":1658195622849},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1657875963855},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/babel-loader/lib/index.js","mtime":1657875486856},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1657875963855},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/vue-loader/lib/index.js","mtime":1657875961434}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGNsYXNzQXBpIGZyb20gIkAvYXBpL2NsYXNzcy5qcyI7CmltcG9ydCB1c2VyQXBpIGZyb20gIkAvYXBpL3VzZXIuanMiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGN1cnJlbnRQYWdlOiAxLAogICAgICB0b3RhbDogMCwKICAgICAgcGFnZVNpemU6IDUsCiAgICAgIGNsYXNzczogW10sCiAgICAgIHVzZXJBbGw6IFtdLAogICAgICBzZWFyY2g6IHsKICAgICAgICB0ZWFjaGVyOiAiIiwKICAgICAgICBtYW5hZ2VyOiAiIgogICAgICB9LAogICAgICBzZWFyY2hNYXA6IHsKICAgICAgICB0ZWFjaGVyX2lkOiAiIiwKICAgICAgICBtYW5hZ2VyX2lkOiAiIgogICAgICB9LAogICAgICB0ZWFjaGVyT3B0aW9uczogW10sCiAgICAgIG1hbmFnZXJPcHRpb25zOiBbXSwKICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLAogICAgICBydWxlczogewogICAgICAgIG5hbWU6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICLnj63nuqflkI3np7Dlv4XpobvloavlhpkiLAogICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgfV0sCiAgICAgICAgdGVhY2hlcl9pZDogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIuivt+mAieaLqeaVmeW4iCIsCiAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICB9XSwKICAgICAgICBtYW5hZ2VyX2lkOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAi6K+36YCJ5oup5a2m566hIiwKICAgICAgICAgIHRyaWdnZXI6ICJibHVyIgogICAgICAgIH1dCiAgICAgIH0sCiAgICAgIHVwZGF0ZUNsYXNzOiB7CiAgICAgICAgX2lkOiBudWxsLAogICAgICAgIG5hbWU6ICIiLAogICAgICAgIHRlYWNoZXJfaWQ6ICIiLAogICAgICAgIG1hbmFnZXJfaWQ6ICIiCiAgICAgIH0KICAgIH07CiAgfSwKCiAgY29tcG9uZW50czoge30sCgogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmZldGNoQ2xhc3MoKTsKICAgIHRoaXMuZ2V0VXNlckxpc3QoKTsKICB9LAoKICBtZXRob2RzOiB7CiAgICByZXNldEZvcm0oZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0ucmVzZXRGaWVsZHMoKTsKICAgIH0sCgogICAgc2VhcmNoRGF0YSgpIHsKICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IDE7CiAgICAgIGNvbnN0IHJlc1RlYWNoZXIgPSB0aGlzLnVzZXJBbGwuZmluZChpdGVtID0+IGl0ZW0ubmFtZSA9PT0gdGhpcy5zZWFyY2gudGVhY2hlcikgfHwge307CiAgICAgIGNvbnN0IHJlc01hbmFnZXIgPSB0aGlzLnVzZXJBbGwuZmluZChpdGVtID0+IGl0ZW0ubmFtZSA9PT0gdGhpcy5zZWFyY2gubWFuYWdlcikgfHwge307CiAgICAgIHRoaXMuc2VhcmNoTWFwLnRlYWNoZXJfaWQgPSByZXNUZWFjaGVyLl9pZCB8fCAiIjsKICAgICAgdGhpcy5zZWFyY2hNYXAubWFuYWdlcl9pZCA9IHJlc01hbmFnZXIuX2lkIHx8ICIiOwogICAgICB0aGlzLmZldGNoQ2xhc3MoKTsKICAgIH0sCgogICAgZmV0Y2hDbGFzcygpIHsKICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgPiBNYXRoLmNlaWwodGhpcy50b3RhbFBhZ2UpKSB7CiAgICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IE1hdGguY2VpbCh0aGlzLnRvdGFsUGFnZSk7CiAgICAgIH0KCiAgICAgIGNsYXNzQXBpLmdldENsYXNzTGlzdCh0aGlzLmN1cnJlbnRQYWdlLCB0aGlzLnBhZ2VTaXplLCB0aGlzLnNlYXJjaE1hcCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgY29uc3QgcmVzID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMCkgewogICAgICAgICAgdGhpcy5jbGFzc3MgPSByZXMuZGF0YS5kYXRhOwogICAgICAgICAgdGhpcy50b3RhbCA9IHJlcy5kYXRhLnRvdGFsOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIGdldFVzZXJMaXN0KCkgewogICAgICB1c2VyQXBpLmdldFVzZXJBbGwoKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBjb25zdCByZXMgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICB0aGlzLnVzZXJBbGwgPSByZXMuZGF0YTsKICAgICAgICAgIHRoaXMudXNlckFsbC5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgICAgICBpZiAoaXRlbS5yb2xlX2lkID09PSAiNjJkYTBmZjQzZDMwM2I1MDFkNDA0NGNhIikgewogICAgICAgICAgICAgIHRoaXMudGVhY2hlck9wdGlvbnMucHVzaChpdGVtKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtLnJvbGVfaWQgPT09ICI2MmQ2N2UyM2FjMjdiMTNhMGU4YmQyZTciIHx8ICI2MmRhMTk2OTNkMzAzYjUwMWQ0MDQ1OGEiKSB7CiAgICAgICAgICAgICAgdGhpcy5tYW5hZ2VyT3B0aW9ucy5wdXNoKGl0ZW0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBmb3JtYXRUZWFjaGVyKHJvdywgY29sdW1uLCBjZWxsVmFsdWUsIGluZGV4KSB7CiAgICAgIGNvbnN0IHRlYWNoZXIgPSB0aGlzLnVzZXJBbGwuZmluZChpdGVtID0+IGl0ZW0uX2lkID09PSBjZWxsVmFsdWUpIHx8IHt9OwogICAgICByZXR1cm4gdGVhY2hlci5uYW1lOwogICAgfSwKCiAgICBmb3JtYXRNYW5hZ2VyKHJvdywgY29sdW1uLCBjZWxsVmFsdWUsIGluZGV4KSB7CiAgICAgIGNvbnN0IG1hbmFnZXIgPSB0aGlzLnVzZXJBbGwuZmluZChpdGVtID0+IGl0ZW0uX2lkID09PSBjZWxsVmFsdWUpIHx8IHt9OwogICAgICByZXR1cm4gbWFuYWdlci5uYW1lOwogICAgfSwKCiAgICBoYW5kbGVFZGl0KF9pZCkgewogICAgICB0aGlzLmhhbmRsZUFkZCgpOwogICAgICBjbGFzc0FwaS5nZXRDbGFzc0J5SWQoX2lkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBjb25zdCByZXNwID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgaWYgKHJlc3Auc3RhdHVzID09IDApIHsKICAgICAgICAgIHRoaXMudXBkYXRlQ2xhc3MgPSByZXNwLmRhdGE7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgaGFuZGxlRGVsZXRlKF9pZCkgewogICAgICB0aGlzLiRjb25maXJtKCLnoa7orqTliKDpmaTor6Xnj63nuqflkJfvvJ8iLCAi5o+Q56S6IiwgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu5a6aIiwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAi5Y+W5raIIiwKICAgICAgICB0eXBlOiAid2FybmluZyIKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgY2xhc3NBcGkuZGVsZXRlQ2xhc3NCeUlkKF9pZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICBjb25zdCByZXNwID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgICBpZiAocmVzcC5zdGF0dXMgPT0gMCkgewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgbWVzc2FnZTogIuWIoOmZpOePree6p+aIkOWKnyEiCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLnRvdGFsUGFnZSA9ICh0aGlzLnRvdGFsIC0gMSkgLyB0aGlzLnBhZ2VTaXplOwogICAgICAgICAgICB0aGlzLmZldGNoQ2xhc3MoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSkuY2F0Y2goKCkgPT4ge30pOwogICAgfSwKCiAgICBoYW5kbGVTaXplQ2hhbmdlKHZhbCkgewogICAgICB0aGlzLnBhZ2VTaXplID0gdmFsOwogICAgICB0aGlzLmZldGNoQ2xhc3MoKTsKICAgIH0sCgogICAgaGFuZGxlQ3VycmVudENoYW5nZSh2YWwpIHsKICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IHZhbDsKICAgICAgdGhpcy5mZXRjaENsYXNzKCk7CiAgICB9LAoKICAgIGFkZERhdGEoZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUodmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgY2xhc3NBcGkuYWRkQ2xhc3ModGhpcy51cGRhdGVDbGFzcykudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHJlc3AgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICAgICAgaWYgKHJlc3Auc3RhdHVzID09IDApIHsKICAgICAgICAgICAgICB0aGlzLmZldGNoQ2xhc3MoKTsKICAgICAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgaGFuZGxlQWRkKCkgewogICAgICB0aGlzLnVwZGF0ZUNsYXNzID0gewogICAgICAgIF9pZDogbnVsbCwKICAgICAgICBuYW1lOiAiIiwKICAgICAgICB0ZWFjaGVyX2lkOiAiIiwKICAgICAgICBtYW5hZ2VyX2lkOiAiIiwKICAgICAgICBzdGFnZTogIiIKICAgICAgfTsKICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IHRydWU7CiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICB0aGlzLiRyZWZzWyJjbGFzc0Zvcm0iXS5yZXNldEZpZWxkcygpOwogICAgICB9KTsKICAgIH0sCgogICAgdXBkYXRlRGF0YShmb3JtTmFtZSkgewogICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS52YWxpZGF0ZSh2YWxpZCA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBjbGFzc0FwaS51cGRhdGVDbGFzcyh0aGlzLnVwZGF0ZUNsYXNzKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgY29uc3QgcmVzcCA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgICAgICBpZiAocmVzcC5zdGF0dXMgPT0gMCkgewogICAgICAgICAgICAgIHRoaXMuZmV0Y2hDbGFzcygpOwogICAgICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICB9Cn07"},{"version":3,"mappings":"AAqIA;AACA;AACA;EACAA;IACA;MACAC,cADA;MAEAC,QAFA;MAGAC,WAHA;MAIAC,UAJA;MAKAC,WALA;MAMAC;QACAC,WADA;QAEAC;MAFA,CANA;MAUAC;QACAC,cADA;QAEAC;MAFA,CAVA;MAcAC,kBAdA;MAeAC,kBAfA;MAgBAC,wBAhBA;MAiBAC;QACAC,OACA;UAAAC;UAAAC;UAAAC;QAAA,CADA,CADA;QAIAT,aACA;UAAAO;UAAAC;UAAAC;QAAA,CADA,CAJA;QAOAR,aACA;UAAAM;UAAAC;UAAAC;QAAA,CADA;MAPA,CAjBA;MA4BAC;QACAC,SADA;QAEAL,QAFA;QAGAN,cAHA;QAIAC;MAJA;IA5BA;EAmCA,CArCA;;EAuCAW,cAvCA;;EAwCAC;IACA;IACA;EACA,CA3CA;;EA4CAC;IACAC;MACA;IAEA,CAJA;;IAKAC;MACA;MACA,mBACA,kEADA;MAEA,mBACA,kEADA;MAEA;MACA;MACA;IACA,CAdA;;IAeAC;MACA;QACA;MACA;;MACAC,SACAC,YADA,CACA,gBADA,EACA,aADA,EACA,cADA,EAEAC,IAFA,CAEAC;QACA;;QACA;UACA;UACA;QACA;MACA,CARA;IASA,CA5BA;;IA6BAC;MACAC;QACA;;QACA;UACA;UACA;YACA;cACA;YACA,CAFA,MAEA,IACAC,+CACA,0BAFA,EAGA;cACA;YACA;UACA,CATA;QAUA;MACA,CAfA;IAgBA,CA9CA;;IA+CAC;MACA;MACA;IACA,CAlDA;;IAmDAC;MACA;MACA;IACA,CAtDA;;IAuDAC;MACA;MACAT;QACA;;QACA;UACA;QACA;MACA,CALA;IAMA,CA/DA;;IAgEAU;MACA;QACAC,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAKAX,IALA,CAKA;QACAF;UACA;;UACA;YACA;cACAa,eADA;cAEAvB;YAFA;YAIA;YACA;UACA;QACA,CAVA;MAWA,CAjBA,EAkBAwB,KAlBA,CAkBA,QAlBA;IAmBA,CApFA;;IAqFAC;MACA;MACA;IACA,CAxFA;;IAyFAC;MACA;MACA;IACA,CA5FA;;IA6FAC;MACA;QACA;UACAjB;YACA;;YACA;cACA;cACA;YACA;UACA,CANA;QAOA,CARA,MAQA;UACA;QACA;MACA,CAZA;IAaA,CA3GA;;IA4GAkB;MACA;QACAzB,SADA;QAEAL,QAFA;QAGAN,cAHA;QAIAC,cAJA;QAKAoC;MALA;MAOA;MACA;QACA;MACA,CAFA;IAGA,CAxHA;;IAyHAC;MACA;QACA;UACApB;YACA;;YACA;cACA;cACA;YACA;UACA,CANA;QAOA,CARA,MAQA;UACA;QACA;MACA,CAZA;IAaA;;EAvIA;AA5CA","names":["data","currentPage","total","pageSize","classs","userAll","search","teacher","manager","searchMap","teacher_id","manager_id","teacherOptions","managerOptions","dialogFormVisible","rules","name","required","message","trigger","updateClass","_id","components","mounted","methods","resetForm","searchData","fetchClass","classApi","getClassList","then","response","getUserList","userApi","item","formatTeacher","formatManager","handleEdit","handleDelete","confirmButtonText","cancelButtonText","type","catch","handleSizeChange","handleCurrentChange","addData","handleAdd","stage","updateData"],"sourceRoot":"src/views/students","sources":["Class.vue"],"sourcesContent":["<template>\n  <div>\n    <el-form\n      :inline=\"true\"\n      :model=\"search\"\n      ref=\"searchForm\"\n      style=\"margin: 20px\"\n    >\n      <el-form-item prop=\"teacher\">\n        <el-input\n          v-model=\"search.teacher\"\n          placeholder=\"根据教师查询\"\n          style=\"width: 200px\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item prop=\"manager\">\n        <el-input\n          v-model=\"search.manager\"\n          placeholder=\"根据学管查询\"\n          style=\"width: 200px\"\n        ></el-input>\n      </el-form-item>\n\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"searchData\" icon=\"el-icon-search\"\n          >查询</el-button\n        >\n        <el-button type=\"primary\" @click=\"handleAdd\" icon=\"el-icon-edit\"\n          >新增</el-button\n        >\n        <el-button type=\"primary\" @click=\"resetForm('searchForm')\"\n          >重置</el-button\n        >\n      </el-form-item>\n    </el-form>\n\n    <el-table :data=\"classs\" height=\"380\" border style=\"width: 100%\">\n      <el-table-column label=\"序号\" type=\"index\" width=\"60\"></el-table-column>\n      <el-table-column label=\"班级名称\" prop=\"name\"></el-table-column>\n      <el-table-column\n        label=\"授课教师\"\n        prop=\"teacher_id\"\n        :formatter=\"formatTeacher\"\n      ></el-table-column>\n      <el-table-column\n        label=\"学管\"\n        prop=\"manager_id\"\n        :formatter=\"formatManager\"\n      ></el-table-column>\n      <el-table-column label=\"操作\" width=\"250\">\n        <template slot-scope=\"scope\">\n          <el-button size=\"mini\" @click=\"handleEdit(scope.row._id)\"\n            >编辑</el-button\n          >\n          <el-button\n            size=\"mini\"\n            type=\"danger\"\n            @click=\"handleDelete(scope.row._id)\"\n            >删除</el-button\n          >\n        </template>\n      </el-table-column>\n    </el-table>\n    <div>\n      <el-pagination\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n        :current-page=\"currentPage\"\n        :page-sizes=\"[5, 10, 15, 20]\"\n        :page-size=\"pageSize\"\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"total\"\n      >\n      </el-pagination>\n    </div>\n    <el-dialog title=\"教师编辑\" :visible.sync=\"dialogFormVisible\" width=\"500px\">\n      <el-form\n        :model=\"updateClass\"\n        status-icon\n        ref=\"classForm\"\n        label-width=\"100px\"\n        label-position=\"right\"\n        style=\"width: 400px\"\n        :rules=\"rules\"\n      >\n        <el-form-item label=\"班级名称\" prop=\"name\">\n          <el-input v-model=\"updateClass.name\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"授课教师\" prop=\"teacher_id\">\n          <el-select\n            v-model=\"updateClass.teacher_id\"\n            placeholder=\"请点击选择\"\n            class=\"filter-item\"\n          >\n            <el-option\n              v-for=\"option in teacherOptions\"\n              :key=\"option._id\"\n              :label=\"option.name\"\n              :value=\"option._id\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"学管\" prop=\"manager_id\">\n          <el-select\n            v-model=\"updateClass.manager_id\"\n            placeholder=\"请点击选择\"\n            class=\"filter-item\"\n          >\n            <el-option\n              v-for=\"option in managerOptions\"\n              :key=\"option._id\"\n              :label=\"option.name\"\n              :value=\"option._id\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n        <el-button\n          type=\"primary\"\n          @click=\"\n            updateClass._id === null\n              ? addData('classForm')\n              : updateData('classForm')\n          \"\n          >确 定</el-button\n        >\n      </div>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport classApi from \"@/api/classs.js\";\nimport userApi from \"@/api/user.js\";\nexport default {\n  data() {\n    return {\n      currentPage: 1,\n      total: 0,\n      pageSize: 5,\n      classs: [],\n      userAll: [],\n      search: {\n        teacher: \"\",\n        manager: \"\",\n      },\n      searchMap: {\n        teacher_id: \"\",\n        manager_id: \"\",\n      },\n      teacherOptions: [],\n      managerOptions: [],\n      dialogFormVisible: false,\n      rules: {\n        name: [\n          { required: true, message: \"班级名称必须填写\", trigger: \"blur\" },\n        ],\n        teacher_id: [\n          { required: true, message: \"请选择教师\", trigger: \"blur\" },\n        ],\n        manager_id: [\n          { required: true, message: \"请选择学管\", trigger: \"blur\" },\n        ],\n      },\n      updateClass: {\n        _id: null,\n        name: \"\",\n        teacher_id: \"\",\n        manager_id: \"\",\n      },\n    };\n  },\n\n  components: {},\n  mounted() {\n    this.fetchClass();\n    this.getUserList();\n  },\n  methods: {\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n      \n    },\n    searchData() {\n      this.currentPage = 1;\n      const resTeacher =\n        this.userAll.find((item) => item.name === this.search.teacher) || {};\n      const resManager =\n        this.userAll.find((item) => item.name === this.search.manager) || {};\n      this.searchMap.teacher_id = resTeacher._id || \"\";\n      this.searchMap.manager_id = resManager._id || \"\";\n      this.fetchClass();\n    },\n    fetchClass() {\n      if(this.currentPage > Math.ceil(this.totalPage)){\n        this.currentPage = Math.ceil(this.totalPage)\n      }\n      classApi\n        .getClassList(this.currentPage, this.pageSize, this.searchMap)\n        .then((response) => {\n          const res = response.data;\n          if (res.status == 0) {\n            this.classs = res.data.data;\n            this.total = res.data.total;\n          }\n        });\n    },\n    getUserList() {\n      userApi.getUserAll().then((response) => {\n        const res = response.data;\n        if (res.status == 0) {\n          this.userAll = res.data;\n          this.userAll.forEach((item) => {\n            if (item.role_id === \"62da0ff43d303b501d4044ca\") {\n              this.teacherOptions.push(item);\n            } else if (\n              item.role_id === \"62d67e23ac27b13a0e8bd2e7\" ||\n              \"62da19693d303b501d40458a\"\n            ) {\n              this.managerOptions.push(item);\n            }\n          });\n        }\n      });\n    },\n    formatTeacher(row, column, cellValue, index) {\n      const teacher = this.userAll.find((item) => item._id === cellValue) || {};\n      return teacher.name;\n    },\n    formatManager(row, column, cellValue, index) {\n      const manager = this.userAll.find((item) => item._id === cellValue) || {};\n      return manager.name;\n    },\n    handleEdit(_id) {\n      this.handleAdd();\n      classApi.getClassById(_id).then((response) => {\n        const resp = response.data;\n        if (resp.status == 0) {\n          this.updateClass = resp.data;\n        }\n      });\n    },\n    handleDelete(_id) {\n      this.$confirm(\"确认删除该班级吗？\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n        .then(() => {\n          classApi.deleteClassById(_id).then((response) => {\n            const resp = response.data;\n            if (resp.status == 0) {\n              this.$message({\n                type: \"success\",\n                message: \"删除班级成功!\",\n              });\n              this.totalPage = (this.total - 1) / this.pageSize;\n              this.fetchClass();\n            }\n          });\n        })\n        .catch(() => {});\n    },\n    handleSizeChange(val) {\n       this.pageSize=val\n      this.fetchClass();\n    },\n    handleCurrentChange(val) {\n      this.currentPage=val\n      this.fetchClass();\n    },\n    addData(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          classApi.addClass(this.updateClass).then((response) => {\n            const resp = response.data;\n            if (resp.status == 0) {\n              this.fetchClass();\n              this.dialogFormVisible = false;\n            }\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    handleAdd() {\n      this.updateClass = {\n        _id: null,\n        name: \"\",\n        teacher_id: \"\",\n        manager_id: \"\",\n        stage: \"\",\n      };\n      this.dialogFormVisible = true;\n      this.$nextTick(() => {\n        this.$refs[\"classForm\"].resetFields();\n      });\n    },\n    updateData(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          classApi.updateClass(this.updateClass).then((response) => {\n            const resp = response.data;\n            if (resp.status == 0) {\n              this.fetchClass();\n              this.dialogFormVisible = false;\n            }\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style scoped>\n</style>"]}]}