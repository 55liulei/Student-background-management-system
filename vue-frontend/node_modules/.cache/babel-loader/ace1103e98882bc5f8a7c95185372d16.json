{"remainingRequest":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/babel-loader/lib/index.js!/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/liulei/Desktop/Vue/vue-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liulei/Desktop/Vue/vue-frontend/src/components/AppHeader/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liulei/Desktop/Vue/vue-frontend/src/components/AppHeader/index.vue","mtime":1658996830678},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/babel.config.js","mtime":1658195622849},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1657875963855},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/babel-loader/lib/index.js","mtime":1657875486856},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1657875963855},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/vue-loader/lib/index.js","mtime":1657875961434}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgeyByZXFXZWF0aGVyIH0gZnJvbSAiQC9hcGkvanNvbnAuanMiOwppbXBvcnQgeyBmb3JtYXRlRGF0ZSB9IGZyb20gIkAvdXRpbHMvZGF0ZVV0aWxzIjsKaW1wb3J0IG1lbW9yeVV0aWxzIGZyb20gIi4uLy4uL3V0aWxzL21lbW9yeVV0aWxzIjsKaW1wb3J0IHN0b3JhZ2VVdGlscyBmcm9tICIuLi8uLi91dGlscy9zdG9yYWdlVXRpbHMiOwppbXBvcnQgdXNlckFwaSBmcm9tICdAL2FwaS91c2VyLmpzJzsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICBjb25zdCB2YWxpZGF0ZU9sZFBhc3MgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgIC8v5qCh6aqM5Y6f5a+G56CBCiAgICAgIHVzZXJBcGkuY2hlY2tQd2QodGhpcy51c2VyLl9pZCwgdmFsdWUpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGNvbnN0IHJlc3AgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICBpZiAocmVzcC5zdGF0dXMgPT0gMCkgewogICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKHJlc3AubXNnKSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CgogICAgY29uc3QgdmFsaWRhdGVQYXNzID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICBpZiAodmFsdWUgIT0gdGhpcy51c2VyRm9ybS5wYXNzKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfkuKTmrKHovpPlhaXlr4bnoIHkuI3kuIDoh7QnKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gewogICAgICB1c2VyOiBtZW1vcnlVdGlscy51c2VyLAogICAgICBjdXJyZW50VGltZTogZm9ybWF0ZURhdGUoRGF0ZS5ub3coKSksCiAgICAgIHRlbV9kYXk6ICIiLAogICAgICB0ZW1fbmlnaHQ6ICIiLAogICAgICB3ZWE6ICIiLAogICAgICB3ZWFfaW1nOiAiIiwKICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLAogICAgICB1c2VyRm9ybTogewogICAgICAgIG9sZFBhc3M6ICIiLAogICAgICAgIHBhc3M6ICIiLAogICAgICAgIGNoZWNrUGFzczogIiIKICAgICAgfSwKICAgICAgcnVsZXM6IHsKICAgICAgICBvbGRQYXNzOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn5pen5a+G56CB5LiN6IO95Li656m6JywKICAgICAgICAgIHRyaWdnZXI6ICJibHVyIgogICAgICAgIH0sIHsKICAgICAgICAgIHZhbGlkYXRvcjogdmFsaWRhdGVPbGRQYXNzLAogICAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgICB9XSwKICAgICAgICBwYXNzOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn5paw5a+G56CB5LiN6IO95Li656m6JywKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH1dLAogICAgICAgIGNoZWNrUGFzczogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ehruiupOWvhueggeS4jeiDveS4uuepuicsCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICB9LCB7CiAgICAgICAgICB2YWxpZGF0b3I6IHZhbGlkYXRlUGFzcywKICAgICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgICAgfV0KICAgICAgfQogICAgfTsKICB9LAoKICBjb21wb25lbnRzOiB7fSwKICBtZXRob2RzOiB7CiAgICBoYW5kbGVDb21tYW5kKGNvbW1hbmQpIHsKICAgICAgc3dpdGNoIChjb21tYW5kKSB7CiAgICAgICAgY2FzZSAiYSI6CiAgICAgICAgICB0aGlzLmhhbmRsZVB3ZCgpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImIiOgogICAgICAgICAgdGhpcy5oYW5kbGVMb2dvdXQoKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0sCgogICAgc3VibWl0Rm9ybShmb3JtTmFtZSkgewogICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS52YWxpZGF0ZSh2YWxpZCA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICB1c2VyQXBpLnVwZGF0ZVB3ZCh0aGlzLnVzZXIuX2lkLCB0aGlzLnVzZXJGb3JtLmNoZWNrUGFzcykudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHJlc3AgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICBtZXNzYWdlOiAi5L+u5pS55a+G56CB5oiQ5YqfIiwKICAgICAgICAgICAgICB0eXBlOiByZXNwLnN0YXR1cyA9PSAwID8gJ3N1Y2Nlc3MnIDogJ3dhcm5pbmcnCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKHJlc3Auc3RhdHVzID09IDApIHsKICAgICAgICAgICAgICB0aGlzLmhhbmRsZUxvZ291dCgpOwogICAgICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBoYW5kbGVMb2dvdXQoKSB7CiAgICAgIG1lbW9yeVV0aWxzLnVzZXIgPSB7fTsKICAgICAgc3RvcmFnZVV0aWxzLnJlbW92ZVVzZXIoKTsKICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UoJy9sb2dpbicpOwogICAgfSwKCiAgICBnZXRXZWF0aGVyKCkgewogICAgICByZXFXZWF0aGVyKCLljJfkuqwiKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBjb25zdCB7CiAgICAgICAgICB0ZW1fZGF5LAogICAgICAgICAgdGVtX25pZ2h0LAogICAgICAgICAgd2VhLAogICAgICAgICAgd2VhX2ltZwogICAgICAgIH0gPSByZXNwb25zZTsKICAgICAgICBjb25zb2xlLmxvZygi5aSp5rCU5L+h5oGvIiwgcmVzcG9uc2UpOwogICAgICAgIGNvbnN0IHdlYUltZ3MgPSB7CiAgICAgICAgICB4dWU6ICJlbC1pY29uLWxpZ2h0LXJhaW4iLAogICAgICAgICAgbGVpOiAiZWwtaWNvbi1saWd0aG5pbmciLAogICAgICAgICAgc2hhY2hlbjogImVsLWljb24tc3VucmlzZSIsCiAgICAgICAgICB3dTogImVsLWljb24tY2xvdWR5LWFuZC1zdW5ueSIsCiAgICAgICAgICBiaW5nYmFvOiAiZWwtaWNvbi1saWdodC1yYWluIiwKICAgICAgICAgIHl1bjogImVsLWljb24tY2xvdWR5IiwKICAgICAgICAgIHl1OiAiZWwtaWNvbi1oZWF2eS1yYWluIiwKICAgICAgICAgIHlpbjogImVsLWljb24tcGFydGx5LWNsb3VkeSIsCiAgICAgICAgICBxaW5nOiAiZWwtaWNvbi1zdW5ueSIKICAgICAgICB9OwogICAgICAgIHRoaXMudGVtX2RheSA9IHRlbV9kYXk7CiAgICAgICAgdGhpcy50ZW1fbmlnaHQgPSB0ZW1fbmlnaHQ7CiAgICAgICAgdGhpcy53ZWEgPSB3ZWE7CiAgICAgICAgdGhpcy53ZWFfaW1nID0gd2VhSW1nc1t3ZWFfaW1nXTsKICAgICAgfSk7CiAgICB9LAoKICAgIGdldFRpbWUoKSB7CiAgICAgIHNldEludGVydmFsKCgpID0+IHsKICAgICAgICB0aGlzLmN1cnJlbnRUaW1lID0gZm9ybWF0ZURhdGUoRGF0ZS5ub3coKSk7CiAgICAgIH0sIDEwMDApOwogICAgfSwKCiAgICBoYW5kbGVQd2QoKSB7CiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSB0cnVlOwogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy4kcmVmc1sndXNlckZvcm0nXS5yZXNldEZpZWxkcygpOwogICAgICB9KTsKICAgIH0KCiAgfSwKCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0V2VhdGhlcigpOwogICAgdGhpcy5nZXRUaW1lKCk7CiAgfQoKfTs="},{"version":3,"mappings":";AA8EA;AACA;AACA;AACA;AACA;AACA;EACAA;IACA;MAAA;MACAC;QACA;;QACA;UACAC;QACA,CAFA,MAEA;UACAA;QACA;MACA,CAPA;IAQA,CATA;;IAUA;MACA;QACAA;MACA,CAFA,MAEA;QACAA;MACA;IACA,CANA;;IAOA;MACAC,sBADA;MAEAC,oCAFA;MAGAC,WAHA;MAIAC,aAJA;MAKAC,OALA;MAMAC,WANA;MAOAC,wBAPA;MAQAC;QACAC,WADA;QAEAC,QAFA;QAGAC;MAHA,CARA;MAaAC;QACAH,UACA;UAAAI;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAC;UAAAD;QAAA,CAFA,CADA;QAKAL,OACA;UAAAG;UAAAC;UAAAC;QAAA,CADA,CALA;QAQAJ,YACA;UAAAE;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAC;UAAAD;QAAA,CAFA;MARA;IAbA;EA2BA,CA9CA;;EAgDAE,cAhDA;EAkDAC;IACAC;MACA;QACA;UACA;UACA;;QACA;UACA;UAEA;;QACA;UACA;MATA;IAWA,CAbA;;IAcAC;MACA;QACA;UACArB;YACA;YACA;cACAe,iBADA;cAEAO;YAFA;;YAIA;cACA;cACA;YACA;UACA,CAVA;QAWA,CAZA,MAYA;UACA;QACA;MACA,CAhBA;IAiBA,CAhCA;;IAiCAC;MACAC;MACAC;MACA;IACA,CArCA;;IAsCAC;MACAC;QACA;UAAAvB;UAAAC;UAAAC;UAAAC;QAAA;QACAqB;QACA;UACAC,yBADA;UAEAC,wBAFA;UAGAC,0BAHA;UAIAC,8BAJA;UAKAC,6BALA;UAMAC,qBANA;UAOAC,wBAPA;UAQAC,4BARA;UASAC;QATA;QAWA;QACA;QACA;QACA;MACA,CAlBA;IAmBA,CA1DA;;IA2DAC;MACAC;QACA;MACA,CAFA,EAEA,IAFA;IAGA,CA/DA;;IAgEAC;MACA;MACA;QACA;MACA,CAFA;IAGA;;EArEA,CAlDA;;EAyHAC;IACA;IACA;EACA;;AA5HA","names":["data","userApi","callback","user","currentTime","tem_day","tem_night","wea","wea_img","dialogFormVisible","userForm","oldPass","pass","checkPass","rules","required","message","trigger","validator","components","methods","handleCommand","submitForm","type","handleLogout","memoryUtils","storageUtils","getWeather","reqWeather","console","xue","lei","shachen","wu","bingbao","yun","yu","yin","qing","getTime","setInterval","handlePwd","mounted"],"sourceRoot":"src/components/AppHeader","sources":["index.vue"],"sourcesContent":["<template>\n  <div class=\"header\">\n    <a href=\"#/\">\n      <img src=\"@/assets/logo.png\" class=\"logo\" width=\"25px\" />\n      <span class=\"company\">东北农业大学管理系统</span>\n    </a>\n    {{/*头部下拉菜单*/}}\n    <el-dropdown @command=\"handleCommand\">\n      <span class=\"el-dropdown-link el-icon-user-solid\">\n        {{ user.username}}<i class=\"el-icon-arrow-down el-icon--right\"></i>\n      </span>\n      <el-dropdown-menu slot=\"dropdown\">\n        <div>\n          <el-dropdown-item command=\"a\" class=\"el-icon-edit-outline\"\n            >修改密码</el-dropdown-item\n          >\n        </div>\n        <div>\n          <el-dropdown-item command=\"b\" class=\"el-icon-s-home\"\n            >退出登录</el-dropdown-item\n          >\n        </div>\n      </el-dropdown-menu>\n    </el-dropdown>\n    <span class=\"date-weather\">\n      <span class=\"date\">{{ currentTime }}</span>\n      &nbsp;&nbsp;|&nbsp;&nbsp;\n      <span class=\"weather\"\n        ><i :class=\"wea_img\"></i>&nbsp;&nbsp; {{ wea }}&nbsp;&nbsp;{{\n          tem_day\n        }}/{{ tem_night }}C&deg;</span\n      >\n    </span>\n        <el-dialog\n      title=\"修改密码\"\n      :visible.sync=\"dialogFormVisible\"\n      width=\"500px\"\n    >\n      <el-form\n        status-icon\n        :model=\"userForm\"\n        ref=\"userForm\"\n        label-width=\"100px\"\n        style=\"width: 400px\"\n        :rules=\"rules\"\n      >\n        <el-form-item label=\"原密码\" prop=\"oldPass\">\n          <el-input\n            v-model=\"userForm.oldPass\"\n            type=\"password\"\n          ></el-input>\n        </el-form-item>\n         <el-form-item label=\"新密码\" prop=\"pass\">\n          <el-input\n            v-model=\"userForm.pass\"\n            type=\"password\"\n          ></el-input>\n        </el-form-item>\n         <el-form-item label=\"确认密码\" prop=\"checkPass\">\n          <el-input\n            v-model=\"userForm.checkPass\"\n            type=\"password\"\n          ></el-input>\n        </el-form-item>\n         <el-form-item>\n          <el-button\n           type=\"primary\"\n           @click=\"submitForm('userForm')\"\n          >提交\n          </el-button>\n          <el-button @click=\"$refs['userForm'].resetFields()\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { reqWeather } from \"@/api/jsonp.js\";\nimport { formateDate } from \"@/utils/dateUtils\";\nimport memoryUtils from \"../../utils/memoryUtils\";\nimport storageUtils from \"../../utils/storageUtils\";\nimport userApi  from   '@/api/user.js'\nexport default {\n  data() {\n    const validateOldPass = (rule,value,callback)=>{//校验原密码\n        userApi.checkPwd(this.user._id,value).then(response=>{\n          const resp = response.data\n          if(resp.status==0){\n            callback()\n          }else{\n            callback(new Error(resp.msg))\n          }\n        })\n    }\n    const validatePass = (rule,value,callback)=>{\n      if(value != this.userForm.pass){\n        callback(new Error('两次输入密码不一致'))\n      }else{\n        callback()\n      }\n    }\n    return {\n      user:memoryUtils.user,\n      currentTime: formateDate(Date.now()),\n      tem_day: \"\",\n      tem_night: \"\",\n      wea: \"\",\n      wea_img: \"\",\n      dialogFormVisible:false,\n      userForm:{\n        oldPass:\"\",\n        pass:\"\",\n        checkPass:\"\"\n      },\n      rules:{\n        oldPass:[\n          {required:true,message:'旧密码不能为空',trigger:\"blur\"},\n          {validator:validateOldPass,trigger:'change'}\n        ],\n        pass:[\n          {required:true,message:'新密码不能为空',trigger:'blur'}\n        ],\n        checkPass:[\n          {required:true,message:'确认密码不能为空',trigger:'blur'},\n          {validator:validatePass,trigger:'change'}\n        ]\n      }\n    };\n  },\n\n  components: {},\n\n  methods: {\n    handleCommand(command) {\n      switch (command) {\n        case \"a\":\n          this.handlePwd()\n          break;\n        case \"b\":\n          this.handleLogout()\n          \n          break;\n        default:\n          break;\n      }\n    },\n    submitForm(formName){\n      this.$refs[formName].validate(valid=>{\n        if(valid){\n          userApi.updatePwd(this.user._id,this.userForm.checkPass).then(response=>{\n            const resp = response.data\n            this.$message({\n              message:\"修改密码成功\",\n              type:resp.status==0?'success':'warning'\n            })\n            if(resp.status==0){\n              this.handleLogout()\n              this.dialogFormVisible=false\n            }\n          })\n        }else{\n            return false\n        }\n      })\n    },\n    handleLogout(){\n       memoryUtils.user={}\n       storageUtils.removeUser();\n       this.$router.replace('/login')\n    },\n    getWeather() {\n      reqWeather(\"北京\").then((response) => {\n        const { tem_day, tem_night, wea, wea_img } = response;\n        console.log(\"天气信息\", response);\n        const weaImgs = {\n          xue: \"el-icon-light-rain\",\n          lei: \"el-icon-ligthning\",\n          shachen: \"el-icon-sunrise\",\n          wu: \"el-icon-cloudy-and-sunny\",\n          bingbao: \"el-icon-light-rain\",\n          yun: \"el-icon-cloudy\",\n          yu: \"el-icon-heavy-rain\",\n          yin: \"el-icon-partly-cloudy\",\n          qing: \"el-icon-sunny\",\n        };\n        this.tem_day = tem_day;\n        this.tem_night = tem_night;\n        this.wea = wea;\n        this.wea_img = weaImgs[wea_img];\n      });\n    },\n    getTime() {\n      setInterval(() => {\n        this.currentTime = formateDate(Date.now());\n      }, 1000);\n    },\n    handlePwd(){\n      this.dialogFormVisible=true;\n      this.$nextTick(()=>{\n        this.$refs['userForm'].resetFields()\n      });\n    }\n  },\n  mounted() {\n    this.getWeather();\n    this.getTime();\n  },\n};\n</script>\n\n<style scoped>\n.header {\n  position: absolute;\n  line-height: 50px;\n  padding: 0px;\n  top: 0px;\n  left: 0px;\n  right: 0px;\n  background-color: #2d3a4b;\n}\n.logo {\n  vertical-align: middle;\n  padding: 0 20px 0 40px;\n}\n.company {\n  position: absolute;\n  color: aliceblue;\n}\n.el-dropdown {\n  float: right;\n  margin-right: 40px;\n}\n.el-dropdown-link {\n  cursor: pointer;\n  color: #409eff;\n}\n.date-weather {\n  float: right;\n  color: white;\n  margin-right: 30px;\n  font-size: 12px;\n}\n</style>"]}]}