{"remainingRequest":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liulei/Desktop/Vue/vue-frontend/src/views/students/Major.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liulei/Desktop/Vue/vue-frontend/src/views/students/Major.vue","mtime":1658735789310},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1657875963855},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/babel-loader/lib/index.js","mtime":1657875486856},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1657875963855},{"path":"/Users/liulei/Desktop/Vue/vue-frontend/node_modules/vue-loader/lib/index.js","mtime":1657875961434}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBtYWpvckFwaSBmcm9tICJAL2FwaS9tYWpvci5qcyI7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbWFqb3JGb3JtVmlzaWJsZTogZmFsc2UsIC8v57yW6L6R56qX5Y+j5piv5ZCm5pi+56S6CiAgICAgIG1ham9yOiB7CiAgICAgICAgX2lkOiBudWxsLAogICAgICAgIG5hbWU6ICIiLAogICAgICB9LAogICAgICBtYWpvcnM6W10sCiAgICAgIHRvdGFsUGFnZToxLAogICAgICBwYWdlU2l6ZTogNSwgLy/mr4/pobXmmL7npLrmnaHmlbAKICAgICAgY3VycmVudFBhZ2U6IDEsIC8v5b2T5YmN6aG1CiAgICAgIHRvdGFsOiAwLCAvL+aAu+iuoQogICAgICBydWxlczogewogICAgICAgIG1ham9yTmFtZTogWwogICAgICAgICAgewogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgICAgbWVzc2FnZTogIuS4k+S4muWQjeensOW/hemhu+i+k+WFpSIsCiAgICAgICAgICAgIHRyaWdnZXI6IFsiYmx1ciIsICJjaGFuZ2UiXSwKICAgICAgICAgIH0sCiAgICAgICAgXSwKICAgICAgfSwKICAgIH07CiAgfSwKICBjb21wb25lbnRzOiB7fSwKICBtb3VudGVkKCl7CiAgICB0aGlzLmZldGNoTWFqb3IoKQogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFkZERhdGEoZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBtYWpvckFwaS5hZGRNYWpvcih0aGlzLm1ham9yKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICBjb25zdCByZXNwID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcCwncmVzJyk7CiAgICAgICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICAgICAgdGhpcy5tYWpvckZvcm1WaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy5mZXRjaE1ham9yKCk7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5re75Yqg5LiT5Lia5oiQ5YqfIiwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJlcnJvciBzdWJtaXQiLCBlcnJvcik7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICB1cGRhdGVEYXRhKGZvcm1OYW1lKSB7CiAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnZhbGlkYXRlKCh2YWxpZCkgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgbWFqb3JBcGkudXBkYXRlTWFqb3IodGhpcy5tYWpvcikudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgY29uc3QgcmVzcCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICAgICAgdGhpcy5tYWpvckZvcm1WaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy5mZXRjaE1ham9yKCk7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5pu05paw5LiT5Lia5oiQ5YqfIiwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJlcnJvciBzdWJtaXQiLCBlcnJvcik7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVBZGQoKSB7CiAgICAgIHRoaXMubWFqb3I9ewogICAgICAgIF9pZDpudWxsLAogICAgICAgIG5hbWU6IiIKICAgICAgfQogICAgICB0aGlzLm1ham9yRm9ybVZpc2libGUgPSB0cnVlOwogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy4kcmVmc1sibWFqb3JGb3JtIl0ucmVzZXRGaWVsZHMoKTsKICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlRWRpdChfaWQpIHsKICAgICAgdGhpcy5oYW5kbGVBZGQoKTsKICAgICAgbWFqb3JBcGkuZ2V0TWFqb3JCeUlkKF9pZCkudGhlbigocmVzcG9uc2UpPT57CiAgICAgICAgY29uc3QgcmVzcCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgaWYocmVzcC5zdGF0dXM9PTApewogICAgICAgICAgdGhpcy5tYWpvciA9IHJlc3AuZGF0YQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAgaGFuZGxlRGVsZXRlKF9pZCkgewogICAgICB0aGlzLiRjb25maXJtKCLnoa7orqTliKDpmaTmlLnnlKjmiLflkJfvvJ8iLCAi5o+Q56S6IiwgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu5a6aIiwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAi5Y+W5raIIiwKICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgIH0pCiAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgbWFqb3JBcGkuZGVsZXRlTWFqb3JCeUlkKF9pZCkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgY29uc3QgcmVzcCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSAwKSB7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5Yig6Zmk5LiT5Lia5oiQ5YqfISIsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdGhpcy50b3RhbFBhZ2UgPSAodGhpcy50b3RhbCAtIDEpL3RoaXMucGFnZVNpemUKICAgICAgICAgICAgICB0aGlzLmZldGNoTWFqb3IoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSkuY2F0Y2goKCkgPT4ge30pOwogICAgfSwKICAgIGhhbmRsZVNpemVDaGFuZ2UodmFsKSB7CiAgICAgdGhpcy5wYWdlU2l6ZT12YWwKICAgICAgdGhpcy5mZXRjaE1ham9yKCk7CiAgICB9LAogICAgaGFuZGxlQ3VycmVudENoYW5nZSh2YWwpIHsKICAgICB0aGlzLmN1cnJlbnRQYWdlPXZhbAogICAgICB0aGlzLmZldGNoTWFqb3IoKTsKICAgIH0sCiAgICBmZXRjaE1ham9yKCkgewogICAgICBpZih0aGlzLmN1cnJlbnRQYWdlID4gTWF0aC5jZWlsKHRoaXMudG90YWxQYWdlKSl7CiAgICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IE1hdGguY2VpbCh0aGlzLnRvdGFsUGFnZSkKICAgICAgfQogICAgICBtYWpvckFwaQogICAgICAgIC5nZXRNYWpvckxpc3QodGhpcy5jdXJyZW50UGFnZSwgdGhpcy5wYWdlU2l6ZSkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIGNvbnN0IHJlcyA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICBjb25zb2xlLmxvZygnLS0tLS0tJyxyZXMpOwogICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMCkgewogICAgICAgICAgICB0aGlzLm1ham9ycyA9IHJlcy5kYXRhLmRhdGE7CiAgICAgICAgICAgIHRoaXMudG90YWwgPSByZXMuZGF0YS50b3RhbDsKICAgICAgICAgICAgIHRoaXMudG90YWxQYWdlID0gdGhpcy50b3RhbC90aGlzLnBhZ2VTaXplCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["Major.vue"],"names":[],"mappings":";AAwEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Major.vue","sourceRoot":"src/views/students","sourcesContent":["<template>\n  <div>\n    <div style=\"margin: 20px\" class=\"btn_bos\">\n      <el-button type=\"primary\" @click=\"handleAdd\">添加专业</el-button>\n    </div>\n    <el-table :data=\"majors\" height=\"380\" border style=\"width: 100%\">\n      <el-table-column label=\"序号\" type=\"index\" width=\"60\"></el-table-column>\n      <el-table-column label=\"专业名称\" prop=\"name\"></el-table-column>\n      <el-table-column label=\"操作\" width=\"250\">\n        <template slot-scope=\"scope\">\n          <el-button size=\"mini\" @click=\"handleEdit(scope.row._id)\"\n            >编辑</el-button\n          >\n          <el-button\n            size=\"mini\"\n            type=\"danger\"\n            @click=\"handleDelete(scope.row._id)\"\n            >删除</el-button\n          >\n        </template>\n      </el-table-column>\n    </el-table>\n    <el-dialog\n      title=\"添加/编辑\"\n      :visible.sync=\"majorFormVisible\"\n      width=\"500px\"\n    >\n      <el-form\n        status-icon\n        :model=\"major\"\n        ref=\"majorForm\"\n        label-width=\"100px\"\n        label-position=\"right\"\n        style=\"width: 400px\"\n        :rules=\"rules\"\n      >\n        <el-form-item label=\"专业名称\" prop=\"name\">\n          <el-input\n            v-model=\"major.name\"\n            placeholder=\"请输入专业名称\"\n          ></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"majorFormVisible = false\">取 消</el-button>\n        <el-button\n          type=\"primary\"\n          @click=\"\n            major._id == null\n              ? addData('majorForm')\n              : updateData('majorForm')\n          \"\n          >确 定</el-button\n        >\n      </div>\n    </el-dialog>\n    <div>\n      <el-pagination\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n        :current-page=\"currentPage\"\n        :page-sizes=\"[5, 10, 15, 20]\"\n        :page-size=\"pageSize\"\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"total\"\n      >\n      </el-pagination>\n    </div>\n  </div>\n</template>\n\n<script>\nimport majorApi from \"@/api/major.js\";\nexport default {\n  data() {\n    return {\n      majorFormVisible: false, //编辑窗口是否显示\n      major: {\n        _id: null,\n        name: \"\",\n      },\n      majors:[],\n      totalPage:1,\n      pageSize: 5, //每页显示条数\n      currentPage: 1, //当前页\n      total: 0, //总计\n      rules: {\n        majorName: [\n          {\n            required: true,\n            message: \"专业名称必须输入\",\n            trigger: [\"blur\", \"change\"],\n          },\n        ],\n      },\n    };\n  },\n  components: {},\n  mounted(){\n    this.fetchMajor()\n  },\n\n  methods: {\n    addData(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          majorApi.addMajor(this.major).then((response) => {\n            const resp = response.data;\n            console.log(resp,'res');\n            if (resp.status == 0) {\n              this.majorFormVisible = false;\n              this.fetchMajor();\n              this.$message({\n                type: \"success\",\n                message: \"添加专业成功\",\n              });\n            }\n          });\n        } else {\n          console.log(\"error submit\", error);\n          return false;\n        }\n      });\n    },\n    updateData(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          majorApi.updateMajor(this.major).then((response) => {\n            const resp = response.data;\n            if (resp.status == 0) {\n              this.majorFormVisible = false;\n              this.fetchMajor();\n              this.$message({\n                type: \"success\",\n                message: \"更新专业成功\",\n              });\n            }\n          });\n        } else {\n          console.log(\"error submit\", error);\n          return false;\n        }\n      });\n    },\n    handleAdd() {\n      this.major={\n        _id:null,\n        name:\"\"\n      }\n      this.majorFormVisible = true;\n      this.$nextTick(() => {\n        this.$refs[\"majorForm\"].resetFields();\n      });\n    },\n    handleEdit(_id) {\n      this.handleAdd();\n      majorApi.getMajorById(_id).then((response)=>{\n        const resp = response.data;\n        if(resp.status==0){\n          this.major = resp.data\n        }\n      })\n    },\n     handleDelete(_id) {\n      this.$confirm(\"确认删除改用户吗？\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n        .then(() => {\n          majorApi.deleteMajorById(_id).then((response) => {\n            const resp = response.data;\n            if (resp.status == 0) {\n              this.$message({\n                type: \"success\",\n                message: \"删除专业成功!\",\n              });\n              this.totalPage = (this.total - 1)/this.pageSize\n              this.fetchMajor();\n            }\n          });\n        }).catch(() => {});\n    },\n    handleSizeChange(val) {\n     this.pageSize=val\n      this.fetchMajor();\n    },\n    handleCurrentChange(val) {\n     this.currentPage=val\n      this.fetchMajor();\n    },\n    fetchMajor() {\n      if(this.currentPage > Math.ceil(this.totalPage)){\n        this.currentPage = Math.ceil(this.totalPage)\n      }\n      majorApi\n        .getMajorList(this.currentPage, this.pageSize)\n        .then((response) => {\n          const res = response.data;\n          console.log('------',res);\n          if (res.status == 0) {\n            this.majors = res.data.data;\n            this.total = res.data.total;\n             this.totalPage = this.total/this.pageSize\n          }\n        });\n    },\n  },\n};\n</script>\n\n<style scoped>\n</style>"]}]}